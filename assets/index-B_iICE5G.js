var ie=Object.defineProperty;var oe=(o,t,n)=>t in o?ie(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n;var At=(o,t,n)=>oe(o,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const v of i)if(v.type==="childList")for(const u of v.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const v={};return i.integrity&&(v.integrity=i.integrity),i.referrerPolicy&&(v.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?v.credentials="include":i.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function s(i){if(i.ep)return;i.ep=!0;const v=n(i);fetch(i.href,v)}})();function tt(){}function ue(o,t){for(const n in t)o[n]=t[n];return o}function Vt(o){return o()}function Jt(){return Object.create(null)}function dt(o){o.forEach(Vt)}function Qt(o){return typeof o=="function"}function ut(o,t){return o!=o?t==t:o!==t||o&&typeof o=="object"||typeof o=="function"}let wt;function jt(o,t){return o===t?!0:(wt||(wt=document.createElement("a")),wt.href=t,o===wt.href)}function fe(o){return Object.keys(o).length===0}function Xt(o,...t){if(o==null){for(const s of t)s(void 0);return tt}const n=o.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function ae(o){let t;return Xt(o,n=>t=n)(),t}function se(o,t,n){o.$$.on_destroy.push(Xt(t,n))}function ce(o,t,n,s){if(o){const i=Yt(o,t,n,s);return o[0](i)}}function Yt(o,t,n,s){return o[1]&&s?ue(n.ctx.slice(),o[1](s(t))):n.ctx}function le(o,t,n,s){if(o[2]&&s){const i=o[2](s(n));if(t.dirty===void 0)return i;if(typeof i=="object"){const v=[],u=Math.max(t.dirty.length,i.length);for(let d=0;d<u;d+=1)v[d]=t.dirty[d]|i[d];return v}return t.dirty|i}return t.dirty}function he(o,t,n,s,i,v){if(i){const u=Yt(t,n,s,v);o.p(u,i)}}function de(o){if(o.ctx.length>32){const t=[],n=o.ctx.length/32;for(let s=0;s<n;s++)t[s]=-1;return t}return-1}function X(o,t){o.appendChild(t)}function q(o,t,n){o.insertBefore(t,n||null)}function F(o){o.parentNode&&o.parentNode.removeChild(o)}function Zt(o,t){for(let n=0;n<o.length;n+=1)o[n]&&o[n].d(t)}function U(o){return document.createElement(o)}function nt(o){return document.createTextNode(o)}function K(){return nt(" ")}function ht(o,t,n,s){return o.addEventListener(t,n,s),()=>o.removeEventListener(t,n,s)}function P(o,t,n){n==null?o.removeAttribute(t):o.getAttribute(t)!==n&&o.setAttribute(t,n)}function pe(o){return Array.from(o.childNodes)}function et(o,t,n,s){n==null?o.style.removeProperty(t):o.style.setProperty(t,n,"")}function _e(o,t,{bubbles:n=!1,cancelable:s=!1}={}){return new CustomEvent(o,{detail:t,bubbles:n,cancelable:s})}let gt;function vt(o){gt=o}function ye(){if(!gt)throw new Error("Function called outside component initialization");return gt}function ve(){const o=ye();return(t,n,{cancelable:s=!1}={})=>{const i=o.$$.callbacks[t];if(i){const v=_e(t,n,{cancelable:s});return i.slice().forEach(u=>{u.call(o,v)}),!v.defaultPrevented}return!0}}function be(o,t){const n=o.$$.callbacks[t.type];n&&n.slice().forEach(s=>s.call(this,t))}const st=[],Pt=[];let lt=[];const Ft=[],ge=Promise.resolve();let Et=!1;function $e(){Et||(Et=!0,ge.then(te))}function $t(o){lt.push(o)}const Gt=new Set;let ft=0;function te(){if(ft!==0)return;const o=gt;do{try{for(;ft<st.length;){const t=st[ft];ft++,vt(t),ke(t.$$)}}catch(t){throw st.length=0,ft=0,t}for(vt(null),st.length=0,ft=0;Pt.length;)Pt.pop()();for(let t=0;t<lt.length;t+=1){const n=lt[t];Gt.has(n)||(Gt.add(n),n())}lt.length=0}while(st.length);for(;Ft.length;)Ft.pop()();Et=!1,Gt.clear(),vt(o)}function ke(o){if(o.fragment!==null){o.update(),dt(o.before_update);const t=o.dirty;o.dirty=[-1],o.fragment&&o.fragment.p(o.ctx,t),o.after_update.forEach($t)}}function me(o){const t=[],n=[];lt.forEach(s=>o.indexOf(s)===-1?t.push(s):n.push(s)),n.forEach(s=>s()),lt=t}const Tt=new Set;let ot;function ee(){ot={r:0,c:[],p:ot}}function ne(){ot.r||dt(ot.c),ot=ot.p}function R(o,t){o&&o.i&&(Tt.delete(o),o.i(t))}function L(o,t,n,s){if(o&&o.o){if(Tt.has(o))return;Tt.add(o),ot.c.push(()=>{Tt.delete(o),s&&(n&&o.d(1),s())}),o.o(t)}else s&&s()}function St(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function Y(o){o&&o.c()}function V(o,t,n){const{fragment:s,after_update:i}=o.$$;s&&s.m(t,n),$t(()=>{const v=o.$$.on_mount.map(Vt).filter(Qt);o.$$.on_destroy?o.$$.on_destroy.push(...v):dt(v),o.$$.on_mount=[]}),i.forEach($t)}function Q(o,t){const n=o.$$;n.fragment!==null&&(me(n.after_update),dt(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function we(o,t){o.$$.dirty[0]===-1&&(st.push(o),$e(),o.$$.dirty.fill(0)),o.$$.dirty[t/31|0]|=1<<t%31}function pt(o,t,n,s,i,v,u=null,d=[-1]){const c=gt;vt(o);const a=o.$$={fragment:null,ctx:[],props:v,update:tt,not_equal:i,bound:Jt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Jt(),dirty:d,skip_bound:!1,root:t.target||c.$$.root};u&&u(a.root);let l=!1;if(a.ctx=n?n(o,t.props||{},(f,w,...j)=>{const p=j.length?j[0]:w;return a.ctx&&i(a.ctx[f],a.ctx[f]=p)&&(!a.skip_bound&&a.bound[f]&&a.bound[f](p),l&&we(o,f)),w}):[],a.update(),l=!0,dt(a.before_update),a.fragment=s?s(a.ctx):!1,t.target){if(t.hydrate){const f=pe(t.target);a.fragment&&a.fragment.l(f),f.forEach(F)}else a.fragment&&a.fragment.c();t.intro&&R(o.$$.fragment),V(o,t.target,t.anchor),te()}vt(c)}class _t{constructor(){At(this,"$$");At(this,"$$set")}$destroy(){Q(this,1),this.$destroy=tt}$on(t,n){if(!Qt(n))return tt;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(t){this.$$set&&!fe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Te="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Te);function je(o){let t,n,s,i,v;const u=o[2].default,d=ce(u,o,o[1],null);return{c(){t=U("button"),d&&d.c(),P(t,"class",n="button "+o[0]+" svelte-1x4k1pl")},m(c,a){q(c,t,a),d&&d.m(t,null),s=!0,i||(v=ht(t,"click",o[3]),i=!0)},p(c,[a]){d&&d.p&&(!s||a&2)&&he(d,u,c,c[1],s?le(u,c[1],a,null):de(c[1]),null),(!s||a&1&&n!==(n="button "+c[0]+" svelte-1x4k1pl"))&&P(t,"class",n)},i(c){s||(R(d,c),s=!0)},o(c){L(d,c),s=!1},d(c){c&&F(t),d&&d.d(c),i=!1,v()}}}function Se(o,t,n){let{$$slots:s={},$$scope:i}=t,{colour:v="green"}=t;function u(d){be.call(this,o,d)}return o.$$set=d=>{"colour"in d&&n(0,v=d.colour),"$$scope"in d&&n(1,i=d.$$scope)},[v,i,s,u]}class ct extends _t{constructor(t){super(),pt(this,t,Se,je,ut,{colour:0})}}const Ot=o=>{switch(o){case"Curse":return"#DC77FF";case"Deck":return"#8995D5";case"Movement":return"#FDFF84";case"Change":return"#FFA944";case"Mystery":return"#F35555";case"Board":return"#88F355";default:return"#FFFFFF"}},xt=o=>`${o}.svg`,qt=o=>{const t=Math.random().toString(36);return o===1?{id:t,cardHalf1:{cardType:{passive:!1,type:"Mystery"},text:"placeholder"},cardHalf2:void 0}:{id:t,cardHalf1:{cardType:{passive:!0,type:"Deck"},text:"placeholder"},cardHalf2:{cardType:{passive:!1,type:"Movement"},text:"placeholder"}}};function Oe(o){let t,n,s,i,v;return{c(){t=U("div"),n=U("div"),s=U("div"),P(s,"contenteditable","true"),P(s,"class","cardText svelte-2sj25y"),o[0].text===void 0&&$t(()=>o[3].call(s)),P(n,"class","card svelte-2sj25y"),et(n,"--colour",o[2]),P(t,"class","wrapper svelte-2sj25y"),et(t,"--rotation",o[1]+"deg")},m(u,d){q(u,t,d),X(t,n),X(n,s),o[0].text!==void 0&&(s.innerText=o[0].text),i||(v=ht(s,"input",o[3]),i=!0)},p(u,[d]){d&1&&u[0].text!==s.innerText&&(s.innerText=u[0].text),d&4&&et(n,"--colour",u[2]),d&2&&et(t,"--rotation",u[1]+"deg")},i:tt,o:tt,d(u){u&&F(t),i=!1,v()}}}function xe(o,t,n){let s,{card:i}=t,{rotation:v=0}=t;function u(){i.text=this.innerText,n(0,i)}return o.$$set=d=>{"card"in d&&n(0,i=d.card),"rotation"in d&&n(1,v=d.rotation)},o.$$.update=()=>{o.$$.dirty&1&&n(2,s=Ot(i.cardType.type))},[i,v,s,u]}class Wt extends _t{constructor(t){super(),pt(this,t,xe,Oe,ut,{card:0,rotation:1})}}function Rt(o,t,n){const s=o.slice();return s[10]=t[n],s}function Ut(o){let t,n=St(o[2]),s=[];for(let i=0;i<n.length;i+=1)s[i]=Lt(Rt(o,n,i));return{c(){t=U("div");for(let i=0;i<s.length;i+=1)s[i].c();P(t,"class","options svelte-lm5vvd"),et(t,"--colour",o[4])},m(i,v){q(i,t,v);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(t,null)},p(i,v){if(v&13){n=St(i[2]);let u;for(u=0;u<n.length;u+=1){const d=Rt(i,n,u);s[u]?s[u].p(d,v):(s[u]=Lt(d),s[u].c(),s[u].m(t,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=n.length}v&16&&et(t,"--colour",i[4])},d(i){i&&F(t),Zt(s,i)}}}function Lt(o){let t,n,s,i,v;function u(){return o[7](o[10])}return{c(){t=U("img"),jt(t.src,n=xt(o[10]))||P(t,"src",n),P(t,"alt","My Icon"),P(t,"class",s="cardIcon "+(o[0]===o[10]?"hidden":"")+" svelte-lm5vvd")},m(d,c){q(d,t,c),i||(v=ht(t,"click",u),i=!0)},p(d,c){o=d,c&4&&!jt(t.src,n=xt(o[10]))&&P(t,"src",n),c&5&&s!==(s="cardIcon "+(o[0]===o[10]?"hidden":"")+" svelte-lm5vvd")&&P(t,"class",s)},d(d){d&&F(t),i=!1,v()}}}function De(o){let t,n,s,i,v,u,d,c,a,l,f,w,j=o[3]&&Ut(o);return{c(){t=U("div"),n=U("img"),i=K(),j&&j.c(),v=K(),u=U("input"),d=K(),c=U("label"),a=nt("Passive"),jt(n.src,s=xt(o[0]))||P(n,"src",s),P(n,"alt","My Icon"),P(n,"class","cardIcon svelte-lm5vvd"),P(t,"class","select svelte-lm5vvd"),P(u,"type","checkbox"),P(u,"id",o[5]),P(u,"class","hidden"),P(c,"for",o[5]),P(c,"class",l="passive no-select "+(o[1]?"":"invisible")+" svelte-lm5vvd")},m(p,m){q(p,t,m),X(t,n),X(t,i),j&&j.m(t,null),q(p,v,m),q(p,u,m),u.checked=o[1],q(p,d,m),q(p,c,m),X(c,a),f||(w=[ht(n,"click",o[6]),ht(u,"change",o[8])],f=!0)},p(p,[m]){m&1&&!jt(n.src,s=xt(p[0]))&&P(n,"src",s),p[3]?j?j.p(p,m):(j=Ut(p),j.c(),j.m(t,null)):j&&(j.d(1),j=null),m&2&&(u.checked=p[1]),m&2&&l!==(l="passive no-select "+(p[1]?"":"invisible")+" svelte-lm5vvd")&&P(c,"class",l)},i:tt,o:tt,d(p){p&&(F(t),F(v),F(u),F(d),F(c)),j&&j.d(),f=!1,dt(w)}}}function Ae(o,t,n){let s,{cardType:i}=t,{passive:v=!1}=t;const u=Math.random().toString(36).substring(7),d=ve();let c=!1,{names:a=["Board","Change","Deck","Movement","Mystery","Curse"]}=t;const l=()=>n(3,c=!c),f=j=>{n(0,i=j),n(3,c=!1)};function w(){v=this.checked,n(1,v)}return o.$$set=j=>{"cardType"in j&&n(0,i=j.cardType),"passive"in j&&n(1,v=j.passive),"names"in j&&n(2,a=j.names)},o.$$.update=()=>{o.$$.dirty&1&&n(4,s=Ot(i)),o.$$.dirty&1&&d("type",i),o.$$.dirty&2&&d("passive",v)},[i,v,a,c,s,u,l,f,w]}class It extends _t{constructor(t){super(),pt(this,t,Ae,De,ut,{cardType:0,passive:1,names:2})}}function Ge(o){let t,n,s,i,v,u,d,c;return s=new It({props:{cardType:o[0].cardType.type,passive:o[0].cardType.passive,names:["Mystery","Curse"]}}),s.$on("type",o[1]),{c(){t=U("div"),n=U("p"),Y(s.$$.fragment),i=K(),v=U("div"),P(n,"class","svelte-1xn06xl"),P(v,"contenteditable","true"),P(v,"class","cardText svelte-1xn06xl"),o[0].text===void 0&&$t(()=>o[2].call(v)),P(t,"class","card svelte-1xn06xl"),et(t,"--colour",Ot(o[0].cardType.type))},m(a,l){q(a,t,l),X(t,n),V(s,n,null),X(t,i),X(t,v),o[0].text!==void 0&&(v.innerText=o[0].text),u=!0,d||(c=ht(v,"input",o[2]),d=!0)},p(a,[l]){const f={};l&1&&(f.cardType=a[0].cardType.type),l&1&&(f.passive=a[0].cardType.passive),s.$set(f),l&1&&a[0].text!==v.innerText&&(v.innerText=a[0].text),(!u||l&1)&&et(t,"--colour",Ot(a[0].cardType.type))},i(a){u||(R(s.$$.fragment,a),u=!0)},o(a){L(s.$$.fragment,a),u=!1},d(a){a&&F(t),Q(s),d=!1,c()}}}function Ne(o,t,n){let{card:s}=t;const i=({detail:u})=>n(0,s.cardType.type=u,s);function v(){s.text=this.innerText,n(0,s)}return o.$$set=u=>{"card"in u&&n(0,s=u.card)},[s,i,v]}class Ee extends _t{constructor(t){super(),pt(this,t,Ne,Ge,ut,{card:0})}}function Ie(o){let t,n;return t=new Ee({props:{card:o[0].cardHalf1}}),{c(){Y(t.$$.fragment)},m(s,i){V(t,s,i),n=!0},p(s,i){const v={};i&1&&(v.card=s[0].cardHalf1),t.$set(v)},i(s){n||(R(t.$$.fragment,s),n=!0)},o(s){L(t.$$.fragment,s),n=!1},d(s){Q(t,s)}}}function Ce(o){let t,n,s,i,v,u,d,c,a,l;return n=new It({props:{cardType:o[0].cardHalf1.cardType.type,passive:o[0].cardHalf1.cardType.passive}}),n.$on("type",o[1]),n.$on("passive",o[2]),i=new Wt({props:{card:o[0].cardHalf1}}),u=new Wt({props:{card:o[0].cardHalf2,rotation:180}}),a=new It({props:{cardType:o[0].cardHalf2.cardType.type,passive:o[0].cardHalf2.cardType.passive}}),a.$on("type",o[3]),a.$on("passive",o[4]),{c(){t=U("p"),Y(n.$$.fragment),s=K(),Y(i.$$.fragment),v=K(),Y(u.$$.fragment),d=K(),c=U("p"),Y(a.$$.fragment),P(t,"class","first svelte-btssnq"),P(c,"class","second svelte-btssnq")},m(f,w){q(f,t,w),V(n,t,null),q(f,s,w),V(i,f,w),q(f,v,w),V(u,f,w),q(f,d,w),q(f,c,w),V(a,c,null),l=!0},p(f,w){const j={};w&1&&(j.cardType=f[0].cardHalf1.cardType.type),w&1&&(j.passive=f[0].cardHalf1.cardType.passive),n.$set(j);const p={};w&1&&(p.card=f[0].cardHalf1),i.$set(p);const m={};w&1&&(m.card=f[0].cardHalf2),u.$set(m);const g={};w&1&&(g.cardType=f[0].cardHalf2.cardType.type),w&1&&(g.passive=f[0].cardHalf2.cardType.passive),a.$set(g)},i(f){l||(R(n.$$.fragment,f),R(i.$$.fragment,f),R(u.$$.fragment,f),R(a.$$.fragment,f),l=!0)},o(f){L(n.$$.fragment,f),L(i.$$.fragment,f),L(u.$$.fragment,f),L(a.$$.fragment,f),l=!1},d(f){f&&(F(t),F(s),F(v),F(d),F(c)),Q(n),Q(i,f),Q(u,f),Q(a)}}}function Me(o){let t,n,s,i;const v=[Ce,Ie],u=[];function d(c,a){return c[0].cardHalf2?0:1}return n=d(o),s=u[n]=v[n](o),{c(){t=U("div"),s.c(),P(t,"class","card svelte-btssnq")},m(c,a){q(c,t,a),u[n].m(t,null),i=!0},p(c,[a]){let l=n;n=d(c),n===l?u[n].p(c,a):(ee(),L(u[l],1,1,()=>{u[l]=null}),ne(),s=u[n],s?s.p(c,a):(s=u[n]=v[n](c),s.c()),R(s,1),s.m(t,null))},i(c){i||(R(s),i=!0)},o(c){L(s),i=!1},d(c){c&&F(t),u[n].d()}}}function Be(o,t,n){let{card:s}=t;const i=({detail:c})=>n(0,s.cardHalf1.cardType.type=c,s),v=({detail:c})=>n(0,s.cardHalf1.cardType.passive=c,s),u=({detail:c})=>{s.cardHalf2&&n(0,s.cardHalf2.cardType.type=c,s)},d=({detail:c})=>{s.cardHalf2&&n(0,s.cardHalf2.cardType.passive=c,s)};return o.$$set=c=>{"card"in c&&n(0,s=c.card)},[s,i,v,u,d]}class He extends _t{constructor(t){super(),pt(this,t,Be,Me,ut,{card:0})}}function Je(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Pe(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Mt={exports:{}};Mt.exports;(function(o){(function(){function t(s,i){return i?Pe(s):s.slice?t[v(s)]:function(u,d){s(u={exports:{}}),t[v(d)]=u.exports};function v(u){return u.split("/").slice(-1).toString().replace(".js","")}}var n=o;t(function(s){String.random=function(v,u){var d="";for(v=v||24,u=u||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";v-- >0;)d+=u.charAt(Math.floor(Math.random()*u.length));return d},String.match=function(v,u){var d,c;return typeof v!="string"?!1:(typeof u=="string"&&(u={"=":u}),u=u||{},d=u["="]||u["*"]||u[">"]||u["<"],v===d?!0:c!==u["="]?!1:(d=u["*"]||u[">"],v.slice(0,(d||"").length)===d?!0:c!==u["*"]?!1:c!==u[">"]&&c!==u["<"]?v>=u[">"]&&v<=u["<"]:c!==u[">"]&&v>=u[">"]||c!==u["<"]&&v<=u["<"]))},String.hash=function(v,u){if(typeof v=="string"){if(u=u||0,!v.length)return u;for(var d=0,c=v.length,a;d<c;++d)a=v.charCodeAt(d),u=(u<<5)-u+a,u|=0;return u}};var i=Object.prototype.hasOwnProperty;Object.plain=function(v){return v?v instanceof Object&&v.constructor===Object||Object.prototype.toString.call(v).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(v,u){for(var d in v)if(i.call(v,d)&&(!u||u.indexOf(d)==-1))return!1;return!0},Object.keys=Object.keys||function(v){var u=[];for(var d in v)i.call(v,d)&&u.push(d);return u},function(){var v,u=setTimeout,d=0,c=0,a=typeof setImmediate!=""+v&&setImmediate||function(f,w){return typeof MessageChannel==""+v?u:((f=new MessageChannel).port1.onmessage=function(j){j.data==""&&w()},function(j){w=j,f.port2.postMessage("")})}(),l=u.check=u.check||typeof performance!=""+v&&performance||{now:function(){return+new Date}};u.hold=u.hold||9,u.poll=u.poll||function(f){if(u.hold>=l.now()-d&&c++<3333){f();return}a(function(){d=l.now(),f()},c=0)}}(),function(){var v=setTimeout,u=v.turn=v.turn||function(w){d.push(w)==1&&c(f)},d=u.s=[],c=v.poll,a=0,l,f=function(){(l=d[a++])&&l(),(a==d.length||a==99)&&(d=u.s=d.slice(a),a=0),d.length&&c(f)}}(),function(){var v,u=setTimeout,d=u.turn;(u.each=u.each||function(c,a,l,f){f=f||9,function w(j,p,m){if(p=(j=(c||[]).splice(0,f)).length){for(var g=0;g<p&&v===(m=a(j[g]));g++);if(v===m){d(w);return}}l&&l(m)}()})()}()})(t,"./shim"),t(function(s){s.exports=function i(l,u,d){if(!l)return{to:i};var c,a=typeof u=="function",l=(this.tag||(this.tag={}))[l]||a&&(this.tag[l]={tag:l,to:i._={next:function(w){var j;(j=this.to)&&j.next(w)}}});if(a){var f={off:i.off||(i.off=function(){if(this.next===i._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=i._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:i._,next:u,the:l,on:this,as:d};return(f.back=l.last||l).to=f,l.last=f}return(l=l.to)&&c!==u&&l.next(u),l}})(t,"./onto"),t(function(s){s.exports=function(i){return i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"&&i!=1/0&&i!=-1/0&&i===i||!!i&&typeof i["#"]=="string"&&Object.keys(i).length===1&&i["#"]}})(t,"./valid"),t(function(s){t("./shim");function i(){var l=+new Date;return c<l?(u=0,c=l+i.drift):c=l+(u+=1)/d+i.drift}i.drift=0;var v=-1/0,u=0,d=999,c=v,a;i.is=function(l,f,w){var j=f&&l&&l._&&l._[">"]||w;if(j)return typeof(j=j[f])=="number"?j:v},i.ify=function(l,f,w,j,p){(l=l||{})._=l._||{},p&&(l._["#"]=p);var m=l._[">"]||(l._[">"]={});return a!==f&&f!=="_"&&(typeof w=="number"&&(m[f]=w),a!==j&&(l[f]=j)),l},s.exports=i})(t,"./state"),t(function(s){t("./shim");function i(v){var u={s:{}},d=u.s;v=v||{max:999,age:1e3*9},u.check=function(a){return d[a]?c(a):!1};var c=u.track=function(a){var l=d[a]||(d[a]={});return l.was=u.now=+new Date,u.to||(u.to=setTimeout(u.drop,v.age+9)),c.ed&&c.ed(a),l};return u.drop=function(a){u.to=null,u.now=+new Date;var l=Object.keys(d);console.STAT&&console.STAT(u.now,+new Date-u.now,"dup drop keys"),setTimeout.each(l,function(f){var w=d[f];w&&(a||v.age)>u.now-w.was||delete d[f]},0,99)},u}s.exports=i})(t,"./dup"),t(function(s){t("./onto"),s.exports=function(u,d){if(this.on){var c=(this.opt||{}).lack||9e3;if(typeof u!="function"){if(!u)return;var l=u["#"]||u,a=(this.tag||"")[l];return a?(d&&(a=this.on(l,d),clearTimeout(a.err),a.err=setTimeout(function(){a.off()},c)),!0):void 0}var l=d&&d["#"]||i(9);if(!u)return l;var f=this.on(l,u,d);return f.err=f.err||setTimeout(function(){f.off(),f.next({err:"Error: No ACK yet.",lack:!0})},c),l}};var i=String.random||function(){return Math.random().toString(36).slice(2)}})(t,"./ask"),t(function(s){function i(p){return p instanceof i?(this._={$:this}).$:this instanceof i?i.create(this._={$:this,opt:p}):new i(p)}i.is=function(p){return p instanceof i||p&&p._&&p===p._.$||!1},i.version=.202,i.chain=i.prototype,i.chain.toJSON=function(){},t("./shim"),i.valid=t("./valid"),i.state=t("./state"),i.on=t("./onto"),i.dup=t("./dup"),i.ask=t("./ask"),function(){i.create=function(r){r.root=r.root||r,r.graph=r.graph||{},r.on=r.on||i.on,r.ask=r.ask||i.ask,r.dup=r.dup||i.dup();var y=r.$.opt(r.opt);return r.once||(r.on("in",p,r),r.on("out",p,r),r.on("put",O,r),i.on("create",r),r.on("create",r)),r.once=1,y};function p(r){if(r){if(r.out===p){this.to.next(r);return}var y=this,$=y.as,I=$.at||$,G=I.$,S=I.dup,N,M=r.DBG;if((N=r["#"])||(N=r["#"]=u(9)),!S.check(N)){if(S.track(N),N=r._,r._=typeof N=="function"?N:function(){},r.$&&r.$===(r.$._||"").$||(r.$=G),r["@"]&&!r.put&&e(r),!I.ask(r["@"],r))if(M&&(M.u=+new Date),r.put){m(r);return}else r.get&&i.on.get(r,G);M&&(M.uc=+new Date),y.to.next(r),M&&(M.ua=+new Date),!(r.nts||r.NTS)&&(r.out=p,I.on("out",r),M&&(M.ue=+new Date))}}}function m(r){if(r){var y=r._||"",$=y.root=((y.$=r.$||"")._||"").root;if(r["@"]&&y.faith&&!y.miss){r.out=p,$.on("out",r);return}y.latch=$.hatch,y.match=$.hatch=[];var I=r.put,G=y.DBG=r.DBG,S=+new Date;if(C=C||S,!(I["#"]&&I["."])){G&&(G.p=S),y["#"]=r["#"],y.msg=r,y.all=0,y.stun=1;var N=Object.keys(I);console.STAT&&console.STAT(S,((G||y).pk=+new Date)-S,"put sort");var M=0,B,H,J,W,z,Z,yt;(function rt(kt){if(B!=M){if(B=M,!(J=N[M])){console.STAT&&console.STAT(S,((G||y).pd=+new Date)-S,"put"),T(y);return}(W=I[J])?(yt=W._)?J!==yt["#"]?Z=k+D(J)+"soul not same.":(z=yt[">"])||(Z=k+D(J)+"no state."):Z=k+D(J)+"no meta.":Z=k+D(J)+"no node.",H=Object.keys(W||{})}if(Z){r.err=y.err=Z,T(y);return}var Bt=0,it;for(kt=kt||0;kt++<9&&(it=H[Bt++]);)if(it!=="_"){var mt=W[it],Ht=z[it];if(f===Ht){Z=k+D(it)+"on"+D(J)+"no state.";break}if(!c(mt)){Z=k+D(it)+"on"+D(J)+"bad "+typeof mt+D(mt);break}g(mt,it,J,Ht,r),++E}if((H=H.slice(Bt)).length){d(rt);return}++M,H=null,rt(kt)})()}}}i.on.put=m;function g(r,y,$,I,G){var S=G._||"",N=S.root,M=N.graph,B,H=M[$]||w,J=a(H,y,1),W=H[y],z=S.DBG;(B=console.STAT)&&(!M[$]||!W)&&(B.has=(B.has||0)+1);var Z=A();if(I>Z){setTimeout(function(){g(r,y,$,I,G)},(B=I-Z)>x?x:B),console.STAT&&console.STAT((z||S).Hf=+new Date,B,"future");return}if(!(I<J)&&!(!S.faith&&I===J&&(r===W||b(r)<=b(W))&&!S.miss)){S.stun++;var yt=G["#"]+S.all++,rt={toString:function(){return yt},_:S};rt.toJSON=rt.toString,N.dup.track(rt)["#"]=G["#"],z&&(z.ph=z.ph||+new Date),N.on("put",{"#":rt,"@":G["@"],put:{"#":$,".":y,":":r,">":I},ok:G.ok,_:S})}}function O(r){var y;(y=(r._||"").DBG)&&(y.pa=+new Date,y.pm=y.pm||+new Date);var $=this,I=$.as,G=I.graph,S=r._,N=r.put,M=N["#"],B=N["."],H=N[":"],J=N[">"];r["#"];var W;(W=S.msg)&&(W=W.put)&&(W=W[M])&&l(W,B,J,H,M),G[M]=l(G[M],B,J,H,M),(W=(I.next||"")[M])&&W.on("in",r),T(S),$.to.next(r)}function T(r,y){var $;if(!r.stop&&!(!r.err&&0<--r.stun)&&(r.stop=1,!!($=r.root))){var I=r.match;I.end=1,I===$.hatch&&(!(I=r.latch)||I.end?delete $.hatch:$.hatch=I),r.hatch&&r.hatch(),setTimeout.each(r.match,function(G){G&&G()}),!(!(y=r.msg)||r.err||y.err)&&(y.out=p,r.root.on("out",y),_())}}function e(r){var y=r["@"]||"",$;if(!($=y._)){var I=(I=r.$)&&(I=I._)&&(I=I.root)&&(I=I.dup);if(!(I=I.check(y)))return;r["@"]=I["#"]||r["@"];return}$.acks=($.acks||0)+1,($.err=r.err)&&(r["@"]=$["#"],T($)),$.ok=r.ok||$.ok,!$.stop&&!$.crack&&($.crack=$.match&&$.match.push(function(){h($)})),h($)}function h(r){!r||!r.root||r.stun||r.acks!==r.all||r.root.on("in",{"@":r["#"],err:r.err,ok:r.err?f:r.ok||{"":1}})}var k="Error: Invalid graph!",D=function(r){return" '"+(""+r).slice(0,9)+"...' "},b=JSON.stringify,x=2147483647,A=i.state,E=0,C,_=function(){E>999&&E/-(C-(C=+new Date))>1&&(i.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),_=function(){E=0})}}(),function(){i.on.get=function(m,g){var O=g._,T=m.get,e=T["#"],h=O.graph[e],k=T["."],D=O.next||(O.next={}),b=D[e],x=m._||{},A=x.DBG=m.DBG;if(A&&(A.g=+new Date),!h)return O.on("get",m);if(k){if((typeof k!="string"||f===h[k])&&!((b||"").next||"")[k]){O.on("get",m);return}h=l({},k,a(h,k),h[k],e)}h&&p(m,h),O.on("get",m)};function p(m,g){var O=+new Date,T=m._||{},e=T.DBG=m.DBG,h=m["#"],k=u(9),D=Object.keys(g||"").sort(),b=((g||"")._||"")["#"];D.length;var x=m.$._.root,A=g===x.graph[b];console.STAT&&console.STAT(O,((e||T).gk=+new Date)-O,"got keys"),g&&function E(){O=+new Date;for(var C=0,_,r={},y;C<9&&(_=D[C++]);)l(r,_,a(g,_),g[_],b);D=D.slice(C),(y={})[b]=r,r=y;var $;A&&($=function(){},$.ram=$.faith=!0),y=D.length,console.STAT&&console.STAT(O,-(O-(O=+new Date)),"got copied some"),e&&(e.ga=+new Date),x.on("in",{"@":h,"#":k,put:r,"%":y?k=u(9):f,$:x.$,_:$,DBG:e,FOO:1}),console.STAT&&console.STAT(O,+new Date-O,"got in"),y&&setTimeout.turn(E)}(),g||x.on("in",{"@":m["#"]})}i.on.get.ack=p}(),function(){i.chain.opt=function(p){p=p||{};var m=this,g=m._,O=p.peers||p;return Object.plain(p)||(p={}),Object.plain(g.opt)||(g.opt=p),typeof O=="string"&&(O=[O]),Object.plain(g.opt.peers)||(g.opt.peers={}),O instanceof Array&&(p.peers={},O.forEach(function(T){var e={};e.id=e.url=T,p.peers[T]=g.opt.peers[T]=g.opt.peers[T]||e})),v(p,function T(e){var h=this[e];if(this&&this.hasOwnProperty(e)||typeof h=="string"||Object.empty(h)){this[e]=h;return}h&&h.constructor!==Object&&!(h instanceof Array)||v(h,T)}),g.opt.from=p,i.on("opt",g),g.opt.uuid=g.opt.uuid||function(e){return i.state().toString(36).replace(".","")+String.random(e||12)},m}}();var v=function(p,m){Object.keys(p).forEach(m,p)},u=String.random,d=setTimeout.turn,c=i.valid,a=i.state.is,l=i.state.ify,f,w={},j;i.log=function(){return!i.log.off&&j.log.apply(j,arguments),[].slice.call(arguments).join(" ")},i.log.once=function(p,m,g){return(g=i.log.once)[p]=g[p]||0,g[p]++||i.log(m)},typeof window<"u"&&((window.GUN=window.Gun=i).window=window);try{typeof n<"u"&&(n.exports=i)}catch{}s.exports=i,(i.window||{}).console=(i.window||{}).console||{log:function(){}},(j=console).only=function(p,m){return j.only.i&&p===j.only.i&&j.only.i++&&(j.log.apply(j,arguments)||m)},i.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(t,"./root"),t(function(s){var i=t("./root");i.chain.back=function(d,c){var a;if(d=d||1,d===-1||d===1/0)return this._.root.$;if(d===1)return(this._.back||this._).$;var l=this,f=l._;if(typeof d=="string"&&(d=d.split(".")),d instanceof Array){var w=0,j=d.length,a=f;for(w;w<j;w++)a=(a||v)[d[w]];return u!==a?c?l:a:(a=f.back)?a.$.back(d,c):void 0}if(typeof d=="function"){for(var p,a={back:f};(a=a.back)&&u===(p=d(a,c)););return p}return typeof d=="number"?(f.back||f).$.back(d-1):this};var v={},u})(t,"./back"),t(function(s){var i=t("./root");i.chain.chain=function(T){var e=this,h=e._,k=new(T||e).constructor(e),D=k._,b;return D.root=b=h.root,D.id=++b.once,D.back=e._,D.on=i.on,D.on("in",i.on.in,D),D.on("out",i.on.out,D),k};function v(T){var e,h=this.as,k=h.back,D=h.root,b;if(T.$||(T.$=h.$),this.to.next(T),h.err){h.on("in",{put:h.put=f,$:h.$});return}if(e=T.get){if(D.pass&&(D.pass[h.id]=h),h.lex&&Object.keys(h.lex).forEach(function(x){b[x]=h.lex[x]},b=T.get=T.get||{}),e["#"]||h.soul){if(e["#"]=e["#"]||h.soul,T["#"]||(T["#"]=w(9)),k=D.$.get(e["#"])._,e=e["."]){if(p(k.put,e)&&(b=k.ask&&k.ask[e],(k.ask||(k.ask={}))[e]=k.$.get(e)._,k.on("in",{get:e,put:{"#":k.soul,".":e,":":k.put[e],">":g(D.graph[k.soul],e)}}),b))return}else{if(b=k.ask&&k.ask[""],(k.ask||(k.ask={}))[""]=k,f!==k.put&&(k.on("in",k),b))return;T.$=k.$}return D.ask(a,T),D.on("in",T)}if(e["."])return h.get?(T={get:{".":h.get},$:h.$},(k.ask||(k.ask={}))[h.get]=T.$._,k.on("out",T)):(T={get:h.lex?T.get:{},$:h.$},k.on("out",T));if((h.ask||(h.ask={}))[""]=h,h.get)return e["."]=h.get,(k.ask||(k.ask={}))[h.get]=T.$._,k.on("out",T)}return k.on("out",T)}i.on.out=v;function u(T,e){e=e||this.as;var h=e.root,k=T.$||(T.$=e.$),D=(k||"")._||l,b=T.put||"",x=b["#"],A=b["."],E=f!==b["="]?b["="]:b[":"],C=b[">"]||-1/0,_;if(f!==T.put&&(f===b["#"]||f===b["."]||f===b[":"]&&f===b["="]||f===b[">"])){if(!j(b)){if(!(x=((b||"")._||"")["#"])){console.log("chain not yet supported for",b,"...",T,e);return}return k=e.root.$.get(x),setTimeout.each(Object.keys(b).sort(),function(r){r=="_"||f===(C=g(b,r))||e.on("in",{$:k,put:{"#":x,".":r,"=":b[r],">":C},VIA:T})})}e.on("in",{$:D.back.$,put:{"#":x=D.back.soul,".":A=D.has||D.get,"=":b,">":g(D.back.put,A)},via:T});return}(T.seen||"")[e.id]||((T.seen||(T.seen=function(){}))[e.id]=e,e!==D&&(Object.keys(T).forEach(function(r){b[r]=T[r]},b={}),b.get=e.get||b.get,!e.soul&&!e.has?b.$$$=b.$$$||e.$:D.soul&&(b.$=e.$,b.$$=b.$$||D.$),T=b),c(T,e),(e.soul||T.$$)&&C>=g(h.graph[x],A)&&((b=h.$.get(x)._).put=O(b.put,A,C,E,x)),!D.soul&&C>=g(h.graph[x],A)&&(_=(h.$.get(x)._.next||"")[A])&&(_.put=E,typeof(b=j(E))=="string"&&(_.put=h.$.get(b)._.put||E)),this.to&&this.to.next(T),e.any&&setTimeout.each(Object.keys(e.any),function(r){(r=e.any[r])&&r(T)},0,99),e.echo&&setTimeout.each(Object.keys(e.echo),function(r){(r=e.echo[r])&&r.on("in",T)},0,99),((T.$$||"")._||D).soul&&(_=e.next)&&(_=_[A])&&(b={},Object.keys(T).forEach(function(r){b[r]=T[r]}),b.$=(T.$$||T.$).get(b.get=A),delete b.$$,delete b.$$$,_.on("in",b)),d(T,e))}i.on.in=u;function d(T,e){if(e=e||this.as||T.$._,!(T.$$&&this!==i.on)&&!(!T.put||e.soul)){var h=T.put||"",k=h["="]||h[":"],A,D=e.root,b=D.$.get(h["#"]).get(h["."])._;if(typeof(k=j(k))!="string"){this===i.on&&((b.echo||(b.echo={}))[e.id]=e);return}if(!((b.echo||(b.echo={}))[e.id]&&!(D.pass||"")[e.id])){if(A=D.pass){if(A[k+e.id])return;A[k+e.id]=1}(b.echo||(b.echo={}))[e.id]=e,e.has&&(e.link=k);var x=D.$.get(b.link=k)._;(x.echo||(x.echo={}))[b.id]=b;var A=e.ask||"";(A[""]||e.lex)&&x.on("out",{get:{"#":k}}),setTimeout.each(Object.keys(A),function(E,C){!E||!(C=A[E])||C.on("out",{get:{"#":k,".":E}})},0,99)}}}i.on.link=d;function c(T,e){var h=T.put||"",k=f!==h["="]?h["="]:h[":"],D=e.root,b,x;if(f===k){if(e.soul&&f!==e.put||(x=(T.$$||T.$||"")._||"",T["@"]&&(f!==x.put||f!==e.put)))return;(b=e.link||T.linked)&&delete(D.$.get(b)._.echo||"")[e.id],e.has&&(e.link=null),e.put=f,setTimeout.each(Object.keys(e.next||""),function(A,E){(E=e.next[A])&&(b&&delete(D.$.get(b).get(A)._.echo||"")[E.id],E.on("in",{get:A,put:f,$:E.$}))},0,99);return}e.soul||T.$$||(b=j(k),x=T.$._||"",!((b===x.link||e.has&&!x.link)&&!((D.pass||"")[e.id]&&typeof b!="string"))&&(delete(x.echo||"")[e.id],c({get:e.get,put:f,$:T.$,linked:T.linked=T.linked||x.link},e)))}i.on.unlink=c;function a(T,e){var h=this.as,k=h.$._;k.root;var D=h.get||"",b=(T.put||"")[D["#"]]||"";if(!T.put||typeof D["."]=="string"&&f===b[D["."]]){if(f!==k.put||!k.soul&&!k.has)return;k.ack=(k.ack||0)+1,k.on("in",{get:k.get,put:k.put=f,$:k.$,"@":T["@"]});return}(T._||{}).miss=1,i.on.put(T)}var l={},f,w=String.random,j=i.valid,p=function(T,e){return T&&Object.prototype.hasOwnProperty.call(T,e)},m=i.state,g=m.is,O=m.ify})(t,"./chain"),t(function(s){var i=t("./root");i.chain.get=function(f,w,j){var p,m;if(typeof f=="string"){if(f.length==0)return(p=this.chain())._.err={err:i.log("0 length key!",f)},w&&w.call(p,p._.err),p;var g=this,O=g._,T=O.next||c;(p=T[f])||(p=f&&v(f,g)),p=p&&p.$}else if(typeof f=="function"){let A=function(E,C,_){if(!A.stun&&!((S=h.pass)&&!S[k])){var r=E.$._,y=(E.$$||"")._,$=(y||r).put,I=!r.has&&!r.soul,G={},S;if((I||l===$)&&($=l===((S=E.put)||"")["="]?l===(S||"")[":"]?S:S[":"]:S["="]),typeof(S=i.valid($))=="string"&&($=l===(S=h.$.get(S)._.put)?e.not?l:$:S),!(e.not&&l===$)){if(l===e.stun){if((S=h.stun)&&S.on&&(O.$.back(function(N){if(S.on(""+N.id,G={}),(G.run||0)<A.id)return G}),!G.run&&S.on(""+r.id,G={}),!G.run&&y&&S.on(""+y.id,G={}),A.id>G.run&&((!G.stun||G.stun.end)&&(G.stun=S.on("stun"),G.stun=G.stun&&G.stun.last),G.stun&&!G.stun.end))){(G.stun.add||(G.stun.add={}))[k]=function(){A(E,C,1)};return}if(l===$&&(_=0),(S=h.hatch)&&!S.end&&l===e.hatch&&!_){if(D[r.$._.id])return;D[r.$._.id]=1,S.push(function(){A(E,C,1)});return}D={}}if(h.pass){if(h.pass[k+r.id])return;h.pass[k+r.id]=1}if(e.on){e.ok.call(r.$,$,r.get,E,C||A);return}if(e.v2020){e.ok(E,C||A);return}Object.keys(E).forEach(function(N){S[N]=E[N]},S={}),E=S,E.put=$,e.ok.call(e.as,E,C||A)}}};var b=A;if(w===!0)return u(this,f,w,j),this;p=this;var O=p._,e=w||{},h=O.root,k;e.at=O,e.ok=f;var D={};return A.at=O,(O.any||(O.any={}))[k=String.random(7)]=A,A.off=function(){A.stun=1,O.any&&delete O.any[k]},A.rid=d,A.id=e.run||++h.once,m=h.pass,(h.pass={})[k]=1,e.out=e.out||{get:{}},O.on("out",e.out),h.pass=m,p}else{if(typeof f=="number")return this.get(""+f,w,j);if(typeof(m=a(f))=="string")return this.get(m,w,j);(m=this.get.next)&&(p=m(this,f))}return p?(w&&typeof w=="function"&&p.get(w,j),p):((p=this.chain())._.err={err:i.log("Invalid get request!",f)},w&&w.call(p,p._.err),p)};function v(f,w){var j=w._,p=j.next,m=w.chain(),g=m._;return p||(p=j.next={}),p[g.get=f]=g,w===j.root.$?g.soul=f:(j.soul||j.has)&&(g.has=f),g}function u(f,w,j,p){var m=f._,g=0,O;return(O=m.soul||m.link)?w(O,p,m):m.jam?m.jam.push([w,p]):(m.jam=[[w,p]],f.get(function(e,h){if(!(l===e.put&&!m.root.opt.super&&(O=Object.keys(m.root.opt.peers).length)&&++g<=O)){h.rid(e);var k=(k=e.$)&&k._||{},D=0,b;for(O=m.jam,delete m.jam;b=O[D++];){var x=b[0];b=b[1],x&&x(k.link||k.soul||i.valid(e.put)||((e.put||{})._||{})["#"],b,e,h)}}},{out:{get:{".":!0}}}),f)}function d(f){var w=this.at||this.on;if(!f||w.soul||w.has)return this.off();if(f=(f=(f=f.$||f)._||f).id){w.map;var j;if((j=this.seen||(this.seen={}))[f])return!0;j[f]=!0}}var c={},a=i.valid,l})(t,"./get"),t(function(s){var i=t("./root");i.chain.put=function(p,m,g){var O=this,T=O._,e=T.root;g=g||{},g.root=T.root,g.run||(g.run=e.once),v(g,T.id),g.ack=g.ack||m,g.via=g.via||O,g.data=g.data||p,g.soul||(g.soul=T.soul||typeof m=="string"&&m);var h=g.state=g.state||i.state();return typeof p=="function"?(p(function(k){g.data=k,O.put(a,a,g)}),O):g.soul?(g.$=e.$.get(g.soul),g.todo=[{it:g.data,ref:g.$}],g.turn=g.turn||f,g.ran=g.ran||u,function k(){var D=g.todo,b=D.pop(),x=b.it;b.ref&&b.ref._.id;var A,E,C,_,r;if(v(g,b.ref),(_=b.todo)&&(E=_.pop(),x=x[E],_.length&&D.push(b)),E&&(D.path||(D.path=[])).push(E),!(A=w(x))&&!(r=i.is(x))){if(!Object.plain(x)){u.err(g,"Invalid data: "+c(x)+" at "+(g.via.back(function(S){S.get&&_.push(S.get)},_=[])||_.join("."))+"."+(D.path||[]).join("."));return}for(var y=g.seen||(g.seen=[]),$=y.length;$--;)if(x===(_=y[$]).it){A=x=_.link;break}}if(E&&A)b.node=j(b.node,E,h,x);else{let S=function(N,M){var B=C.link["#"];M&&(M.off(),M.rid(N));var H=B||N.soul||(_=(N.$$||N.$)._||"").soul||_.link||((_=_.put||"")._||"")["#"]||_["#"]||((_=N.put||"")&&N.$$?_["#"]:(_["="]||_[":"]||"")["#"]);if(!B&&v(g,N.$),!H&&!b.link["#"]){(b.wait||(b.wait=[])).push(function(){S(N,M)});return}H||(H=[],(N.$$||N.$).back(function(J){if(_=J.soul||J.link)return H.push(_);H.push(J.get)}),H=H.reverse().join("/")),C.link["#"]=H,!r&&(((g.graph||(g.graph={}))[H]=C.node||(C.node={_:{}}))._["#"]=H),delete g.wait[I],C.wait&&setTimeout.each(C.wait,function(J){J&&J()}),g.ran(g)};var G=S;if(!g.seen){u.err(g,"Data at root of graph must be a node (an object).");return}g.seen.push(C={it:x,link:{},todo:r?[]:Object.keys(x).sort().reverse(),path:(D.path||[]).slice(),up:b}),b.node=j(b.node,E,h,C.link),!r&&C.todo.length&&D.push(C);var I=g.seen.length;(g.wait||(g.wait={}))[I]="",_=(C.ref=r?x:E?b.ref.get(E):b.ref)._,(_=x&&(x._||"")["#"]||_.soul||_.link)?S({soul:_}):C.ref.get(S,{run:g.run,v2020:1,out:{get:{".":" "}}})}if(!D.length)return g.ran(g);g.turn(k)}(),O):(d(g),O)};function v(p,m){if(m){m=(m._||"").id||m;var g=p.root.stun||(p.root.stun={on:i.on}),O={},T;p.stun||(p.stun=g.on("stun",function(){})),(T=g.on(""+m))&&T.the.last.next(O),!(O.run>=p.run)&&g.on(""+m,function(e){if(p.stun.end){this.off(),this.to.next(e);return}e.run=e.run||p.run,e.stun=e.stun||p.stun})}}function u(p){if(p.err){u.end(p.stun,p.root);return}if(!(p.todo.length||p.end||!Object.empty(p.wait))){p.end=1;var m=p.$.back(-1)._,g=m.root,O=m.ask(function(k){g.on("ack",k),k.err&&!k.lack&&i.log(k),++T>(p.acks||0)&&this.off(),p.ack&&p.ack(k,this)},p.opt),T=0,e=p.stun,h;(h=function(){e&&(u.end(e,g),setTimeout.each(Object.keys(e=e.add||""),function(k){(k=e[k])&&k()}))}).hatch=h,p.ack&&!p.ok&&(p.ok=p.acks||9),p.via._.on("out",{put:p.out=p.graph,ok:p.ok&&{"@":p.ok+1},opt:p.opt,"#":O,_:h})}}u.end=function(p,m){p.end=l,p.the.to===p&&p===p.the.last&&delete m.stun,p.off()},u.err=function(p,m){(p.ack||l).call(p,p.out={err:p.err=i.log(m)}),p.ran(p)};function d(p){var m=p.via._,g;p.via=p.via.back(function(O){if(O.soul||!O.get)return O.$;g=p.data,(p.data={})[O.get]=g}),(!p.via||!p.via._.soul)&&(p.via=m.root.$.get(((p.data||"")._||"")["#"]||m.$.back("opt.uuid")())),p.via.put(p.data,p.ack,p)}function c(p,m){return p&&(m=p.constructor)&&m.name||typeof p}var a,l=function(){},f=setTimeout.turn,w=i.valid,j=i.state.ify})(t,"./put"),t(function(s){var i=t("./root");t("./chain"),t("./back"),t("./put"),t("./get"),s.exports=i})(t,"./index"),t(function(s){var i=t("./index");i.chain.on=function(d,c,a,l){var f=this,w=f._;w.root;var j;if(typeof d=="string")return c?(j=w.on(d,c,a||w,l),a&&a.$&&(a.subs||(a.subs=[])).push(j),f):w.on(d);var p=c;return(p=p===!0?{change:!0}:p||{}).not=1,p.on=1,f.get(d,p),f},i.chain.once=function(d,c){if(c=c||{},!d)return v(this);var a=this,l=a._,f=l.root;l.put;var w=String.random(7),j;return a.get(function(p,m,g,O){var T=this,e=T._,h=e.one||(e.one={});if(O.stun||h[w]==="")return;if((j=i.valid(p))===!0){k();return}if(typeof j=="string")return;clearTimeout((l.one||"")[w]),clearTimeout(h[w]),h[w]=setTimeout(k,c.wait||99);function k(D){if(!e.has&&!e.soul&&(e={put:p,get:m}),u===(j=e.put)&&(j=((g.$$||"")._||"").put),typeof i.valid(j)=="string"&&(j=f.$.get(j)._.put,j===u&&!D)){h[w]=setTimeout(function(){k(1)},c.wait||99);return}O.stun||h[w]!==""&&(h[w]="",(l.soul||l.has)&&O.off(),d.call(T,j,e.get),clearTimeout(h[w]))}},{on:1}),a};function v(d,c,a){return i.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(a=d.chain())._.nix=d.once(function(l,f){a._.on("in",this._)}),a._.lex=d._.lex,a}i.chain.off=function(){var d=this,c=d._,a,l=c.back;if(l)return c.ack=0,(a=l.next)&&a[c.get]&&delete a[c.get],(a=l.any)&&(delete l.any,l.any={}),(a=l.ask)&&delete a[c.get],(a=l.put)&&delete a[c.get],(a=c.soul)&&delete l.root.graph[a],(a=c.map)&&Object.keys(a).forEach(function(f,w){w=a[f],w.link&&l.root.$.get(w.link).off()}),(a=c.next)&&Object.keys(a).forEach(function(f,w){w=a[f],w.$.off()}),c.on("off",{}),d};var u})(t,"./on"),t(function(s){var i=t("./index"),v=i.chain.get.next;i.chain.get.next=function(a,l){var f;return Object.plain(l)?(f=((f=l["#"])||"")["="]||f)?a.get(f):((f=a.chain()._).lex=l,a.on("in",function(w){String.match(w.get||(w.put||"")["."],l["."]||l["#"]||l)&&f.on("in",w),this.to.next(w)}),f.$):(v||d)(a,l)},i.chain.map=function(a,l,f){var w=this,j=w._,p,m;return Object.plain(a)&&(p=a["."]?a:{".":a},a=c),a?(i.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),m=w.chain(),w.map().on(function(g,O,T,e){var h=(a||d).call(this,g,O,T,e);if(c!==h){if(g===h)return m._.on("in",T);if(i.is(h))return m._.on("in",h._);var k={};Object.keys(T.put).forEach(function(D){k[D]=T.put[D]},k),k["="]=h,m._.on("in",{get:O,put:k})}}),m):((m=j.each)||((j.each=m=w.chain())._.lex=p||m._.lex||j.lex,m._.nix=w.back("nix"),w.on("in",u,m._)),m)};function u(a){this.to.next(a);var l=this.as,f=a.$,w=f._,j=a.put,p;!w.soul&&!a.$$||(p=l.lex)&&!String.match(a.get||(j||"")["."],p["."]||p["#"]||p)||i.on.link(a,l)}var d=function(){},c})(t,"./map"),t(function(s){var i=t("./index");i.chain.set=function(v,u,d){var c=this,a=c.back(-1),l,f;return u=u||function(){},d=d||{},d.item=d.item||v,(l=((v||"")._||"")["#"])&&((v={})["#"]=l),typeof(f=i.valid(v))=="string"?c.get(l=f).put(v,u,d):i.is(v)?(c.put(function(w){v.get(function(j,p,m){if(!j)return u.call(c,{err:i.log('Only a node can be linked! Not "'+m.put+'"!')});(f={})[j]={"#":j},w(f)},!0)}),v):(Object.plain(v)&&(v=a.get(l=c.back("opt.uuid")()).put(v)),c.get(l||a.back("opt.uuid")(7)).put(v,u,d))}})(t,"./set"),t(function(s){t("./shim");var i=function(){},v=JSON.parseAsync||function(a,l,f){var w,j=+new Date;try{l(w,JSON.parse(a,f),u.sucks(+new Date-j))}catch(p){l(p)}},u=JSON.stringifyAsync||function(a,l,f,w){var j,p=+new Date;try{l(j,JSON.stringify(a,f,w),u.sucks(+new Date-p))}catch(m){l(m)}};u.sucks=function(a){a>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),u.sucks=i)};function d(a){var l=function(){},f=a.opt||{};f.log=f.log||console.log,f.gap=f.gap||f.wait||0,f.max=f.max||(f.memory?f.memory*999*999:3e8)*.3,f.pack=f.pack||f.max*.01*.01,f.puff=f.puff||9;var w=setTimeout.turn||setTimeout,j=a.dup,p=j.check,m=j.track,g=l.hear=function(e,h){if(e){if(f.max<=e.length)return l.say({dam:"!",err:"Message too big!"},h);l===this&&(g.d+=e.length||0,++g.c);var k=h.SH=+new Date,D=e[0],b;if(D==="["){v(e,function(x,A){if(x||!A)return l.say({dam:"!",err:"DAM JSON parse error."},h);console.STAT&&console.STAT(+new Date,A.length,"# on hear batch");var E=f.puff;(function C(){for(var _=+new Date,r=0,y;r<E&&(y=A[r++]);)l.hear(y,h);A=A.slice(r),console.STAT&&console.STAT(_,+new Date-_,"hear loop"),O(h),A.length&&w(C,0)})()}),e="";return}if(D==="{"||(e["#"]||Object.plain(e))&&(b=e)){if(b)return g.one(b,h,k);v(e,function(x,A){if(x||!A)return l.say({dam:"!",err:"DAM JSON parse error."},h);g.one(A,h,k)});return}}};g.one=function(e,h,C){var D,b,x,A,E;if(e.DBG&&(e.DBG=E={DBG:e.DBG}),E&&(E.h=C),E&&(E.hp=+new Date),(D=e["#"])||(D=e["#"]=String.random(9)),!(x=p(D))&&(b=e["##"],!(b&&(x=e["@"]||e.get&&D)&&j.check(A=x+b)))){if((e._=function(){}).via=l.leap=h,(x=e["><"])&&typeof x=="string"&&x.slice(0,99).split(",").forEach(function(_){this[_]=1},e._.yo={}),x=e.dam){(x=l.hear[x])&&x(e,h,a),m(D);return}(x=e.ok)&&(e._.near=x["/"]);var C=+new Date;E&&(E.is=C),h.SI=D,m.ed=function(_){D===_&&(m.ed=0,(_=j.s[D])&&(_.via=h,e.get&&(_.it=e)))},a.on("in",l.last=e),E&&(E.hd=+new Date),console.STAT&&console.STAT(C,+new Date-C,e.get?"msg get":e.put?"msg put":"msg"),m(D),A&&m(A),l.leap=l.last=null}},g.c=g.d=0,function(){var e=0,h;l.hash=function(b,x){var A,E,C,_=+new Date;u(b.put,function r(y,$){var I=(E||(E=C=$||"")).slice(0,32768);if(A=String.hash(I,A),E=E.slice(32768),E){w(r,0);return}console.STAT&&console.STAT(_,+new Date-_,"say json+hash"),b._.$put=C,b["##"]=A,l.say(b,x),delete b._.$put},k)};function k(b,x){var A;return x instanceof Object?(Object.keys(x).sort().forEach(D,{to:A={},on:x}),A):x}function D(b){this.to[b]=this.on[b]}l.say=function(b,x){var A;if((A=this)&&(A=A.to)&&A.next&&A.next(b),!b)return!1;var E,C,_,r=b["@"],y=b._||(b._=function(){}),$=b.DBG,I=+new Date;if(y.y=y.y||I,x||$&&($.y=I),(E=b["#"])||(E=b["#"]=String.random(9)),!h&&m(E),!(C=b["##"])&&c!==b.put&&!y.via&&r){l.hash(b,x);return}if(!x&&r&&(x=(A=j.s[r])&&(A.via||(A=A.it)&&(A=A._)&&A.via)||(A=l.last)&&r===A["#"]&&l.leap),!x&&r)return j.s[r]?void 0:(console.STAT&&console.STAT(+new Date,++e,"total no peer to ack to"),!1);if(r&&!b.put&&!C&&((j.s[r]||"").it||"")["##"])return!1;if(!x&&l.way)return l.way(b);if($&&($.yh=+new Date),!(_=y.raw)){l.raw(b,x);return}if($&&($.yr=+new Date),!x||!x.id){if(!Object.plain(x||f.peers))return!1;var I=+new Date;f.puff;var G=f.peers,S=Object.keys(x||f.peers||{});console.STAT&&console.STAT(I,+new Date-I,"peer keys"),function B(){var H=+new Date;h=1;var J=y.raw;y.raw=_;for(var W=0,z;W<9&&(z=(S||"")[W++]);)(z=G[z]||(x||"")[z])&&l.say(b,z);y.raw=J,h=0,S=S.slice(W),console.STAT&&console.STAT(H,+new Date-H,"say loop"),S.length&&(w(B,0),r&&m(r))}();return}if(!x.wire&&l.wire&&l.wire(x),E!==x.last){if(x.last=E,x===y.via||(A=y.yo)&&(A[x.url]||A[x.pid]||A[x.id]))return!1;if(console.STAT&&console.STAT(I,(($||y).yp=+new Date)-(y.y||I),"say prep"),!h&&r&&m(r),x.batch){if(x.tail=(A=x.tail||0)+_.length,x.tail<=f.pack){x.batch+=(A?",":"")+_;return}O(x)}x.batch="[";var N=+new Date;setTimeout(function(){console.STAT&&console.STAT(N,+new Date-N,"0ms TO"),O(x)},f.gap),T(_,x),console.STAT&&r===x.SI&&console.STAT(I,+new Date-x.SH,"say ack")}},l.say.c=l.say.d=0,l.raw=function(b,x){if(!b)return"";var A=b._||{},E,C;if(C=A.raw)return C;if(typeof b=="string")return b;var _=b["##"],r=b["@"];if(_&&r){if(!A.via&&p(r+_))return!1;if(C=(j.s[r]||"").it){if(_===C["##"])return!1;C["##"]||(C["##"]=_)}}if(!b.dam&&!b["@"]){var y=0,$=[];C=f.peers;for(var I in C){var G=C[I];if($.push(G.url||G.pid||G.id),++y>6)break}y>1&&(b["><"]=$.join())}if(b.put&&(C=b.ok)&&(b.ok={"@":(C["@"]||1)-1,"/":C["/"]==b._.near?l.near:C["/"]}),E=A.$put){C={},Object.keys(b).forEach(function(N){C[N]=b[N]}),C.put=":])([:",u(C,function(N,M){if(!N){var B=+new Date;C=M.indexOf('"put":":])([:"'),S(c,M=M.slice(0,C+6)+E+M.slice(C+14)),console.STAT&&console.STAT(B,+new Date-B,"say slice")}});return}u(b,S);function S(N,M){N||(A.raw=M,l.say(b,x))}}}();function O(e){var h=e.batch,k=typeof h=="string";if(k&&(h+="]"),e.batch=e.tail=null,!!h&&!(k?3>h.length:!h.length)){if(!k)try{h=h.length===1?h[0]:JSON.stringify(h)}catch(D){return f.log("DAM JSON stringify error",D)}h&&T(h,e)}}function T(e,h){try{var k=h.wire;h.say?h.say(e):k.send&&k.send(e),l.say.d+=e.length||0,++l.say.c}catch{(h.queue=h.queue||[]).push(e)}}return l.near=0,l.hi=function(e){var h=e.wire,k;if(!h){l.wire(e.length&&{url:e,id:e}||e);return}e.id?f.peers[e.url||e.id]=e:(k=e.id=e.id||e.url||String.random(9),l.say({dam:"?",pid:a.opt.pid},f.peers[k]=e),delete j.s[e.last]),e.met||(l.near++,e.met=+new Date,a.on("hi",e)),k=e.queue,e.queue=[],setTimeout.each(k||[],function(D){T(D,e)},0,9)},l.bye=function(e){e.met&&--l.near,delete e.met,a.on("bye",e);var h=+new Date;h=h-(e.met||h),l.bye.time=((l.bye.time||h)+h)/2},l.hear["!"]=function(e,h){f.log("Error:",e.err)},l.hear["?"]=function(e,h){e.pid&&(h.pid||(h.pid=e.pid),e["@"])||(l.say({dam:"?",pid:f.pid,"@":e["#"]},h),delete j.s[h.last])},l.hear.mob=function(e,h){if(e.peers){var k=Object.keys(e.peers),D=k[Math.random()*k.length>>0];D&&(l.bye(h),l.hi(D))}},a.on("create",function(e){e.opt.pid=e.opt.pid||String.random(9),this.to.next(e),e.on("out",l.say)}),a.on("bye",function(e,h){e=f.peers[e.id||e]||e,this.to.next(e),e.bye?e.bye():(h=e.wire)&&h.close&&h.close(),delete f.peers[e.id],e.wire=null}),a.on("bye",function(e,h){this.to.next(e),(h=console.STAT)&&(h.peers=l.near),(h=e.url)&&setTimeout(function(){},f.lack||9e3)}),a.on("hi",function(e,h){if(this.to.next(e),(h=console.STAT)&&(h.peers=l.near),!f.super){var k=Object.keys(a.next||"");k.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(k,function(D){var b=a.next[D];if(f.super||(b.ask||"")[""]){l.say({get:{"#":D}},e);return}setTimeout.each(Object.keys(b.ask||""),function(x){x&&l.say({"##":String.hash((a.graph[D]||"")[x]),get:{"#":D,".":x}},e)})})}}),l}var c;try{s.exports=d}catch{}})(t,"./mesh"),t(function(s){var i=t("./index");i.Mesh=t("./mesh"),i.on("opt",function(u){if(this.to.next(u),u.once)return;var d=u.opt;if(d.WebSocket===!1)return;var c=i.window||{},a=d.WebSocket||c.WebSocket||c.webkitWebSocket||c.mozWebSocket;if(!a)return;d.WebSocket=a;var l=d.mesh=d.mesh||i.Mesh(u);l.wire||d.wire,l.wire=d.wire=f;function f(m){try{if(!m||!m.url)return O&&O(m);var g=m.url.replace(/^http/,"ws"),O=m.wire=new d.WebSocket(g);return O.onclose=function(){j(m),d.mesh.bye(m)},O.onerror=function(T){j(m)},O.onopen=function(){d.mesh.hi(m)},O.onmessage=function(T){T&&d.mesh.hear(T.data||T,m)},O}catch{d.mesh.bye(m)}}setTimeout(function(){!d.super&&u.on("out",{dam:"hi"})},1);var w=2*999;function j(m){clearTimeout(m.defer),d.peers[m.url]&&(p&&m.retry<=0||(m.retry=(m.retry||d.retry+1||60)-(-m.tried+(m.tried=+new Date)<w*4?1:0),m.defer=setTimeout(function g(){if(p&&p.hidden)return setTimeout(g,w);f(m)},w)))}var p=""+v!=typeof document&&document});var v})(t,"./websocket"),t(function(s){if(!(typeof Gun>"u")){var i=function(){},v;try{v=(Gun.window||i).localStorage}catch{}v||(Gun.log("Warning: No localStorage exists to persist data to!"),v={setItem:function(d,c){this[d]=c},removeItem:function(d){delete this[d]},getItem:function(d){return this[d]}});var u=JSON.stringifyAsync||function(d,c,a,l){var f;try{c(f,JSON.stringify(d,a,l))}catch(w){c(w)}};Gun.on("create",function d(c){this.to.next(c);var a=c.opt;c.graph;var l=[],f,w,j,p;if(a.localStorage===!1)return;a.prefix=a.file||"gun/";try{f=d[a.prefix]=d[a.prefix]||JSON.parse(j=v.getItem(a.prefix))||{}}catch{f=d[a.prefix]={}}j=(j||"").length,c.on("get",function(g){this.to.next(g);var O=g.get,T,e,h,k;!O||!(T=O["#"])||(e=f[T]||k,e&&(h=O["."])&&!Object.plain(h)&&(e=Gun.state.ify({},h,Gun.state.is(e,h),e[h],T)),Gun.on.get.ack(g,e))}),c.on("put",function(g){this.to.next(g);var O=g.put,T=O["#"],e=O["."],h=g["#"],k=g.ok||"";if(f[T]=Gun.state.ify(f[T],e,O[">"],O[":"],T),p&&j>4999880){c.on("in",{"@":h,err:"localStorage max!"});return}!g["@"]&&(!g._.via||Math.random()<k["@"]/k["/"])&&l.push(h),!w&&(w=setTimeout(m,9+j/333))});function m(){if(!l.length&&((setTimeout.turn||"").s||"").length){setTimeout(m,99);return}var g=l;clearTimeout(w),w=!1,l=[],u(f,function(O,T){try{!O&&v.setItem(a.prefix,T)}catch(e){O=p=e||"localStorage failure"}O&&(Gun.log(O+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),c.on("localStorage:error",{err:O,get:a.prefix,put:f})),j=T.length,setTimeout.each(g,function(e){c.on("in",{"@":e,err:O,ok:0})},0,99)})}})}})(t,"./localStorage")})(),function(){var C;if(""+C!=typeof Gun){var t=function(_){console.warn("Warning! Deprecated internal utility will break in next version:",_)},n=Gun;n.fn=n.fn||{is:function(_){return t("fn"),!!_&&typeof _=="function"}},n.bi=n.bi||{is:function(_){return t("bi"),_ instanceof Boolean||typeof _=="boolean"}},n.num=n.num||{is:function(_){return t("num"),!s(_)&&(_-parseFloat(_)+1>=0||_===1/0||_===-1/0)}},n.text=n.text||{is:function(_){return t("text"),typeof _=="string"}},n.text.ify=n.text.ify||function(_){return t("text.ify"),n.text.is(_)?_:typeof JSON<"u"?JSON.stringify(_):_&&_.toString?_.toString():_},n.text.random=n.text.random||function(_,r){t("text.random");var y="";for(_=_||24,r=r||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";_>0;)y+=r.charAt(Math.floor(Math.random()*r.length)),_--;return y},n.text.match=n.text.match||function(_,r){var y,$;return t("text.match"),typeof _!="string"?!1:(typeof r=="string"&&(r={"=":r}),r=r||{},y=r["="]||r["*"]||r[">"]||r["<"],_===y?!0:$!==r["="]?!1:(y=r["*"]||r[">"]||r["<"],_.slice(0,(y||"").length)===y?!0:$!==r["*"]?!1:$!==r[">"]&&$!==r["<"]?_>=r[">"]&&_<=r["<"]:$!==r[">"]&&_>=r[">"]||$!==r["<"]&&_<=r["<"]))},n.text.hash=n.text.hash||function(_,r){if(t("text.hash"),typeof _=="string"){if(r=r||0,!_.length)return r;for(var y=0,$=_.length,I;y<$;++y)I=_.charCodeAt(y),r=(r<<5)-r+I,r|=0;return r}},n.list=n.list||{is:function(_){return t("list"),_ instanceof Array}},n.list.slit=n.list.slit||Array.prototype.slice,n.list.sort=n.list.sort||function(_){return t("list.sort"),function(r,y){return!r||!y?0:(r=r[_],y=y[_],r<y?-1:r>y?1:0)}},n.list.map=n.list.map||function(_,r,y){return t("list.map"),A(_,r,y)},n.list.index=1,n.obj=n.boj||{is:function(_){return t("obj"),_?_ instanceof Object&&_.constructor===Object||Object.prototype.toString.call(_).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},n.obj.put=n.obj.put||function(_,r,y){return t("obj.put"),(_||{})[r]=y,_},n.obj.has=n.obj.has||function(_,r){return t("obj.has"),_&&Object.prototype.hasOwnProperty.call(_,r)},n.obj.del=n.obj.del||function(_,r){if(t("obj.del"),!!_)return _[r]=null,delete _[r],_},n.obj.as=n.obj.as||function(_,r,y,$){return t("obj.as"),_[r]=_[r]||($===y?{}:y)},n.obj.ify=n.obj.ify||function(_){if(t("obj.ify"),h(_))return _;try{_=JSON.parse(_)}catch{_={}}return _},function(){var _;function r(y,$){D(this,$)&&_!==this[$]||(this[$]=y)}n.obj.to=n.obj.to||function(y,$){return t("obj.to"),$=$||{},A(y,r,$),$}}(),n.obj.copy=n.obj.copy||function(_){return t("obj.copy"),_&&JSON.parse(JSON.stringify(_))},function(){function _(r,y){var $=this.n,I;if(!($&&(y===$||h($)&&D($,y)))&&I!==y)return!0}n.obj.empty=n.obj.empty||function(r,y){return t("obj.empty"),r?!A(r,_,{n:y}):!0}}(),function(){function _($,I){if(arguments.length===2){_.r=_.r||{},_.r[$]=I;return}_.r=_.r||[],_.r.push($)}var r=Object.keys,y;Object.keys=Object.keys||function($){return y($,function(I,G,S){S(G)})},n.obj.map=y=n.obj.map||function($,I,G){t("obj.map");var S,N=0,M,B,H,J,W=typeof I=="function";if(_.r=S,r&&h($)&&(H=r($),J=!0),G=G||{},s($)||H)for(M=(H||$).length;N<M;N++){var z=N+n.list.index;if(W){if(B=J?I.call(G,$[H[N]],H[N],_):I.call(G,$[N],z,_),B!==S)return B}else if(I===$[J?H[N]:N])return H?H[N]:z}else for(N in $)if(W){if(D($,N)&&(B=G?I.call(G,$[N],N,_):I($[N],N,_),B!==S))return B}else if(I===$[N])return N;return W?_.r:n.list.index?0:-1}}(),n.time=n.time||{},n.time.is=n.time.is||function(_){return t("time"),_?_ instanceof Date:+new Date().getTime()};var T=n.fn.is,s=n.list.is,e=n.obj,h=e.is,D=e.has,A=e.map,i={};i.is=function(_){return t("val.is"),_===C?!1:_===null?!0:_===1/0?!1:d(_)||u(_)||p(_)?!0:i.link.is(_)||!1},i.link=i.rel={_:"#"},function(){i.link.is=function(r){if(t("val.link.is"),r&&r[v]&&!r._&&h(r)){var y={};if(A(r,_,y),y.id)return y.id}return!1};function _(r,y){var $=this;if($.id)return $.id=!1;if(y==v&&d(r))$.id=r;else return $.id=!1}}(),i.link.ify=function(_){return t("val.link.ify"),x({},v,_)},n.obj.has._=".";var v=i.link._,C,u=n.bi.is,p=n.num.is,d=n.text.is,e=n.obj,h=e.is,x=e.put,A=e.map;n.val=n.val||i;var c={_:"_"};c.soul=function(_,r){return t("node.soul"),_&&_._&&_._[r||f]},c.soul.ify=function(_,r){return t("node.soul.ify"),r=typeof r=="string"?{soul:r}:r||{},_=_||{},_._=_._||{},_._[f]=r.soul||_._[f]||l(),_},c.soul._=i.link._,function(){c.is=function(r,y,$){t("node.is");var I;return h(r)&&(I=c.soul(r))?!A(r,_,{as:$,cb:y,s:I,n:r}):!1};function _(r,y){if(y!==c._){if(!i.is(r))return!0;this.cb&&this.cb.call(this.as,r,y,this.n,this.s)}}}(),function(){c.ify=function(r,y,$){return t("node.ify"),y?typeof y=="string"?y={soul:y}:typeof y=="function"&&(y={map:y}):y={},y.map&&(y.node=y.map.call($,r,C,y.node||{})),(y.node=c.soul.ify(y.node||{},y))&&A(r,_,{o:y,as:$}),y.node};function _(r,y){var $=this.o,I,G;if($.map){I=$.map.call(this.as,r,""+y,$.node),G===I?k($.node,y):$.node&&($.node[y]=I);return}i.is(r)&&($.node[y]=r)}}();var e=n.obj,h=e.is,k=e.del,A=e.map,a=n.text,l=a.random,f=c.soul._,C;n.node=n.node||c;var w=n.state;w.lex=function(){return t("state.lex"),w().toString(36).replace(".","")},w.to=function(_,r,y){t("state.to");var $=(_||{})[r];return h($)&&($=E($)),w.ify(y,r,w.is(_,r),$,c.soul(_))},function(){w.map=function(r,y,$){t("state.map");var I,G=h(G=r||y)?G:null;return r=T(r=r||y)?r:null,G&&!r?(y=p(y)?y:w(),G[g]=G[g]||{},A(G,_,{o:G,s:y}),G):($=$||h(y)?y:I,y=p(y)?y:w(),function(S,N,M,B){if(!r)return _.call({o:M,s:y},S,N),S;r.call($||this||{},S,N,M,B),!(D(M,N)&&I===M[N])&&_.call({o:M,s:y},S,N)})};function _(r,y){g!==y&&w.ify(this.o,y,this.s)}}();var e=n.obj;e.as;var D=e.has,h=e.is,A=e.map,E=e.copy,j=n.num,p=j.is,m=n.fn,T=m.is,g=c._,C,O={};(function(){O.is=function(y,$,I,G){return t("graph.is"),!y||!h(y)||b(y)?!1:!A(y,_,{cb:$,fn:I,as:G})};function _(y,$){if(!y||$!==c.soul(y)||!c.is(y,this.fn,this.as))return!0;this.cb&&(r.n=y,r.as=this.as,this.cb.call(r.as,y,$,r))}function r(y){y&&c.is(r.n,y,r.as)}})(),function(){O.ify=function(G,S,N){t("graph.ify");var M={path:[],obj:G};return S?typeof S=="string"?S={soul:S}:typeof S=="function"&&(S.map=S):S={},typeof N=="string"&&(S.soul=S.soul||N,N=C),S.soul&&(M.link=i.link.ify(S.soul)),S.shell=(N||{}).shell,S.graph=S.graph||{},S.seen=S.seen||[],S.as=S.as||N,_(S,M),S.root=M.node,S.graph};function _(G,S){var N;return(N=I(G,S))?N:(S.env=G,S.soul=y,c.ify(S.obj,r,S)&&(S.link=S.link||i.link.ify(c.soul(S.node)),S.obj!==G.shell&&(G.graph[i.link.is(S.link)]=S.node)),S)}function r(G,S,N){var M=this,B=M.env,H,J;if(c._===S&&D(G,i.link._))return N._;if(H=$(G,S,N,M,B)){if(S||(M.node=M.node||N||{},D(G,c._)&&c.soul(G)&&(M.node._=E(G._)),M.node=c.soul.ify(M.node,i.link.is(M.link)),M.link=M.link||i.link.ify(c.soul(M.node))),(J=B.map)&&(J.call(B.as||{},G,S,N,M),D(N,S))){if(G=N[S],C===G){k(N,S);return}if(!(H=$(G,S,N,M,B)))return}if(!S)return M.node;if(H===!0)return G;if(J=_(B,{obj:G,path:M.path.concat(S)}),!!J.node)return J.link}}function y(G){var S=this,N=i.link.is(S.link),M=S.env.graph;S.link=S.link||i.link.ify(G),S.link[i.link._]=G,S.node&&S.node[c._]&&(S.node[c._][i.link._]=G),D(M,N)&&(M[G]=M[N],k(M,N))}function $(G,S,N,M,B){var H;if(i.is(G))return!0;if(h(G))return 1;if(H=B.invalid)return G=H.call(B.as||{},G,S,N),$(G,S,N,M,B);B.err="Invalid value at '"+M.path.concat(S).join(".")+"'!",n.list.is(G)&&(B.err+=" Use `.set(item)` instead of an Array.")}function I(G,S){for(var N=G.seen,M=N.length,B;M--;)if(B=N[M],S.obj===B.obj)return B;N.push(S)}}(),O.node=function(_){t("graph.node");var r=c.soul(_);if(r)return x({},r,_)},function(){O.to=function(r,y,$){if(t("graph.to"),!!r){var I={};return $=$||{seen:{}},A(r[y],_,{obj:I,graph:r,opt:$}),I}};function _(r,y){var $,I;if(c._===y){if(b(r,i.link._))return;this.obj[y]=E(r);return}if(!($=i.link.is(r))){this.obj[y]=r;return}if(I=this.opt.seen[$]){this.obj[y]=I;return}this.obj[y]=this.opt.seen[$]=O.to(this.graph,$,this.opt)}}();var T=n.fn.is,e=n.obj,h=e.is,k=e.del,D=e.has,b=e.empty,x=e.put,A=e.map,E=e.copy,C;n.graph=n.graph||O}}()})(Mt);var Fe=Mt.exports,qe=Fe;const We=Je(qe),at=[];function Re(o,t=tt){let n;const s=new Set;function i(d){if(ut(o,d)&&(o=d,n)){const c=!at.length;for(const a of s)a[1](),at.push(a,o);if(c){for(let a=0;a<at.length;a+=2)at[a][0](at[a+1]);at.length=0}}}function v(d){i(d(o))}function u(d,c=tt){const a=[d,c];return s.add(a),s.size===1&&(n=t(i,v)||tt),d(o),()=>{s.delete(a),s.size===0&&n&&(n(),n=null)}}return{set:i,update:v,subscribe:u}}const Ue=We({peers:["wss://gun-manhattan.herokuapp.com/gun"]}),re=Ue.get("cards"),Nt=document.createElement("a"),Dt=document.createElement("input");Dt.type="file";Dt.accept=".json";Dt.onchange=async o=>{var n;if(!o||!o.target)return;const t=(n=o.target.files)==null?void 0:n[0];if(t){const s=await t.text();Ct(JSON.parse(s))}};const bt=Re([]),Ct=o=>{re.put({data:JSON.stringify(o)})};re.on(o=>{bt.set(JSON.parse(o.data))});const Le=()=>{Nt.href=URL.createObjectURL(new Blob([JSON.stringify(ae(bt))],{type:"application/json"})),Nt.download="cards.json",Nt.click()},ze=()=>{Dt.click()};function zt(o,t,n){const s=o.slice();return s[5]=t[n],s}function Ke(o){let t;return{c(){t=nt("add two sided")},m(n,s){q(n,t,s)},d(n){n&&F(t)}}}function Ve(o){let t;return{c(){t=nt("add one sided")},m(n,s){q(n,t,s)},d(n){n&&F(t)}}}function Qe(o){let t;return{c(){t=nt("save")},m(n,s){q(n,t,s)},d(n){n&&F(t)}}}function Xe(o){let t;return{c(){t=nt("import JSON")},m(n,s){q(n,t,s)},d(n){n&&F(t)}}}function Ye(o){let t;return{c(){t=nt("export JSON")},m(n,s){q(n,t,s)},d(n){n&&F(t)}}}function Ze(o){let t;return{c(){t=nt("remove")},m(n,s){q(n,t,s)},d(n){n&&F(t)}}}function Kt(o){let t,n,s,i,v,u;n=new He({props:{card:o[5]}});function d(){return o[4](o[5])}return i=new ct({props:{colour:"red",$$slots:{default:[Ze]},$$scope:{ctx:o}}}),i.$on("click",d),{c(){t=U("div"),Y(n.$$.fragment),s=K(),Y(i.$$.fragment),v=K(),P(t,"class","wrapper svelte-z9e1s4")},m(c,a){q(c,t,a),V(n,t,null),X(t,s),V(i,t,null),X(t,v),u=!0},p(c,a){o=c;const l={};a&1&&(l.card=o[5]),n.$set(l);const f={};a&256&&(f.$$scope={dirty:a,ctx:o}),i.$set(f)},i(c){u||(R(n.$$.fragment,c),R(i.$$.fragment,c),u=!0)},o(c){L(n.$$.fragment,c),L(i.$$.fragment,c),u=!1},d(c){c&&F(t),Q(n),Q(i)}}}function tn(o){let t,n,s,i,v,u,d,c,a,l,f,w,j,p,m;n=new ct({props:{colour:"blue",$$slots:{default:[Ke]},$$scope:{ctx:o}}}),n.$on("click",o[1]),i=new ct({props:{colour:"blue",$$slots:{default:[Ve]},$$scope:{ctx:o}}}),i.$on("click",o[2]),u=new ct({props:{$$slots:{default:[Qe]},$$scope:{ctx:o}}}),u.$on("click",o[3]),c=new ct({props:{$$slots:{default:[Xe]},$$scope:{ctx:o}}}),c.$on("click",ze),l=new ct({props:{$$slots:{default:[Ye]},$$scope:{ctx:o}}}),l.$on("click",Le);let g=St(o[0]),O=[];for(let e=0;e<g.length;e+=1)O[e]=Kt(zt(o,g,e));const T=e=>L(O[e],1,1,()=>{O[e]=null});return{c(){t=U("section"),Y(n.$$.fragment),s=K(),Y(i.$$.fragment),v=K(),Y(u.$$.fragment),d=K(),Y(c.$$.fragment),a=K(),Y(l.$$.fragment),f=K(),w=U("h1"),w.textContent="cards",j=K(),p=U("section");for(let e=0;e<O.length;e+=1)O[e].c();P(t,"class","button-container svelte-z9e1s4"),P(p,"class","container svelte-z9e1s4")},m(e,h){q(e,t,h),V(n,t,null),X(t,s),V(i,t,null),X(t,v),V(u,t,null),X(t,d),V(c,t,null),X(t,a),V(l,t,null),q(e,f,h),q(e,w,h),q(e,j,h),q(e,p,h);for(let k=0;k<O.length;k+=1)O[k]&&O[k].m(p,null);m=!0},p(e,[h]){const k={};h&256&&(k.$$scope={dirty:h,ctx:e}),n.$set(k);const D={};h&256&&(D.$$scope={dirty:h,ctx:e}),i.$set(D);const b={};h&256&&(b.$$scope={dirty:h,ctx:e}),u.$set(b);const x={};h&256&&(x.$$scope={dirty:h,ctx:e}),c.$set(x);const A={};if(h&256&&(A.$$scope={dirty:h,ctx:e}),l.$set(A),h&1){g=St(e[0]);let E;for(E=0;E<g.length;E+=1){const C=zt(e,g,E);O[E]?(O[E].p(C,h),R(O[E],1)):(O[E]=Kt(C),O[E].c(),R(O[E],1),O[E].m(p,null))}for(ee(),E=g.length;E<O.length;E+=1)T(E);ne()}},i(e){if(!m){R(n.$$.fragment,e),R(i.$$.fragment,e),R(u.$$.fragment,e),R(c.$$.fragment,e),R(l.$$.fragment,e);for(let h=0;h<g.length;h+=1)R(O[h]);m=!0}},o(e){L(n.$$.fragment,e),L(i.$$.fragment,e),L(u.$$.fragment,e),L(c.$$.fragment,e),L(l.$$.fragment,e),O=O.filter(Boolean);for(let h=0;h<O.length;h+=1)L(O[h]);m=!1},d(e){e&&(F(t),F(f),F(w),F(j),F(p)),Q(n),Q(i),Q(u),Q(c),Q(l),Zt(O,e)}}}function en(o,t,n){let s;return se(o,bt,c=>n(0,s=c)),[s,()=>{bt.set([...s,qt(2)])},()=>{bt.set([...s,qt(1)]),console.log(s.length)},()=>{Ct(s)},c=>{Ct(s.filter(a=>a.id!==c.id))}]}class nn extends _t{constructor(t){super(),pt(this,t,en,tn,ut,{})}}new nn({target:document.getElementById("app")});
