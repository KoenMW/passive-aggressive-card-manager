var ee=Object.defineProperty;var ne=(o,t,i)=>t in o?ee(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i;var Dt=(o,t,i)=>ne(o,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const v of r)if(v.type==="childList")for(const u of v.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(r){const v={};return r.integrity&&(v.integrity=r.integrity),r.referrerPolicy&&(v.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?v.credentials="include":r.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function s(r){if(r.ep)return;r.ep=!0;const v=i(r);fetch(r.href,v)}})();function tt(){}function re(o,t){for(const i in t)o[i]=t[i];return o}function Lt(o){return o()}function Mt(){return Object.create(null)}function lt(o){o.forEach(Lt)}function Kt(o){return typeof o=="function"}function ot(o,t){return o!=o?t==t:o!==t||o&&typeof o=="object"||typeof o=="function"}let $t;function jt(o,t){return o===t?!0:($t||($t=document.createElement("a")),$t.href=t,o===$t.href)}function ie(o){return Object.keys(o).length===0}function oe(o,...t){if(o==null){for(const s of t)s(void 0);return tt}const i=o.subscribe(...t);return i.unsubscribe?()=>i.unsubscribe():i}function ue(o,t,i){o.$$.on_destroy.push(oe(t,i))}function fe(o,t,i,s){if(o){const r=Vt(o,t,i,s);return o[0](r)}}function Vt(o,t,i,s){return o[1]&&s?re(i.ctx.slice(),o[1](s(t))):i.ctx}function ae(o,t,i,s){if(o[2]&&s){const r=o[2](s(i));if(t.dirty===void 0)return r;if(typeof r=="object"){const v=[],u=Math.max(t.dirty.length,r.length);for(let h=0;h<u;h+=1)v[h]=t.dirty[h]|r[h];return v}return t.dirty|r}return t.dirty}function se(o,t,i,s,r,v){if(r){const u=Vt(t,i,s,v);o.p(u,r)}}function ce(o){if(o.ctx.length>32){const t=[],i=o.ctx.length/32;for(let s=0;s<i;s++)t[s]=-1;return t}return-1}function X(o,t){o.appendChild(t)}function q(o,t,i){o.insertBefore(t,i||null)}function J(o){o.parentNode&&o.parentNode.removeChild(o)}function Qt(o,t){for(let i=0;i<o.length;i+=1)o[i]&&o[i].d(t)}function R(o){return document.createElement(o)}function ht(o){return document.createTextNode(o)}function K(){return ht(" ")}function ct(o,t,i,s){return o.addEventListener(t,i,s),()=>o.removeEventListener(t,i,s)}function F(o,t,i){i==null?o.removeAttribute(t):o.getAttribute(t)!==i&&o.setAttribute(t,i)}function le(o){return Array.from(o.childNodes)}function et(o,t,i,s){i==null?o.style.removeProperty(t):o.style.setProperty(t,i,"")}function he(o,t,{bubbles:i=!1,cancelable:s=!1}={}){return new CustomEvent(o,{detail:t,bubbles:i,cancelable:s})}let vt;function _t(o){vt=o}function de(){if(!vt)throw new Error("Function called outside component initialization");return vt}function pe(){const o=de();return(t,i,{cancelable:s=!1}={})=>{const r=o.$$.callbacks[t];if(r){const v=he(t,i,{cancelable:s});return r.slice().forEach(u=>{u.call(o,v)}),!v.defaultPrevented}return!0}}function ye(o,t){const i=o.$$.callbacks[t.type];i&&i.slice().forEach(s=>s.call(this,t))}const at=[],Bt=[];let st=[];const Ht=[],_e=Promise.resolve();let Gt=!1;function ve(){Gt||(Gt=!0,_e.then(Xt))}function bt(o){st.push(o)}const At=new Set;let ut=0;function Xt(){if(ut!==0)return;const o=vt;do{try{for(;ut<at.length;){const t=at[ut];ut++,_t(t),be(t.$$)}}catch(t){throw at.length=0,ut=0,t}for(_t(null),at.length=0,ut=0;Bt.length;)Bt.pop()();for(let t=0;t<st.length;t+=1){const i=st[t];At.has(i)||(At.add(i),i())}st.length=0}while(at.length);for(;Ht.length;)Ht.pop()();Gt=!1,At.clear(),_t(o)}function be(o){if(o.fragment!==null){o.update(),lt(o.before_update);const t=o.dirty;o.dirty=[-1],o.fragment&&o.fragment.p(o.ctx,t),o.after_update.forEach(bt)}}function ge(o){const t=[],i=[];st.forEach(s=>o.indexOf(s)===-1?t.push(s):i.push(s)),i.forEach(s=>s()),st=t}const mt=new Set;let it;function Yt(){it={r:0,c:[],p:it}}function Zt(){it.r||lt(it.c),it=it.p}function z(o,t){o&&o.i&&(mt.delete(o),o.i(t))}function L(o,t,i,s){if(o&&o.o){if(mt.has(o))return;mt.add(o),it.c.push(()=>{mt.delete(o),s&&(i&&o.d(1),s())}),o.o(t)}else s&&s()}function St(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}function Z(o){o&&o.c()}function V(o,t,i){const{fragment:s,after_update:r}=o.$$;s&&s.m(t,i),bt(()=>{const v=o.$$.on_mount.map(Lt).filter(Kt);o.$$.on_destroy?o.$$.on_destroy.push(...v):lt(v),o.$$.on_mount=[]}),r.forEach(bt)}function Q(o,t){const i=o.$$;i.fragment!==null&&(ge(i.after_update),lt(i.on_destroy),i.fragment&&i.fragment.d(t),i.on_destroy=i.fragment=null,i.ctx=[])}function ke(o,t){o.$$.dirty[0]===-1&&(at.push(o),ve(),o.$$.dirty.fill(0)),o.$$.dirty[t/31|0]|=1<<t%31}function dt(o,t,i,s,r,v,u=null,h=[-1]){const c=vt;_t(o);const a=o.$$={fragment:null,ctx:[],props:v,update:tt,not_equal:r,bound:Mt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:Mt(),dirty:h,skip_bound:!1,root:t.target||c.$$.root};u&&u(a.root);let l=!1;if(a.ctx=i?i(o,t.props||{},(f,w,...$)=>{const p=$.length?$[0]:w;return a.ctx&&r(a.ctx[f],a.ctx[f]=p)&&(!a.skip_bound&&a.bound[f]&&a.bound[f](p),l&&ke(o,f)),w}):[],a.update(),l=!0,lt(a.before_update),a.fragment=s?s(a.ctx):!1,t.target){if(t.hydrate){const f=le(t.target);a.fragment&&a.fragment.l(f),f.forEach(J)}else a.fragment&&a.fragment.c();t.intro&&z(o.$$.fragment),V(o,t.target,t.anchor),Xt()}_t(c)}class pt{constructor(){Dt(this,"$$");Dt(this,"$$set")}$destroy(){Q(this,1),this.$destroy=tt}$on(t,i){if(!Kt(i))return tt;const s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(i),()=>{const r=s.indexOf(i);r!==-1&&s.splice(r,1)}}$set(t){this.$$set&&!ie(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const $e="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add($e);function me(o){let t,i,s,r,v;const u=o[2].default,h=fe(u,o,o[1],null);return{c(){t=R("button"),h&&h.c(),F(t,"class",i="button "+o[0]+" svelte-1x4k1pl")},m(c,a){q(c,t,a),h&&h.m(t,null),s=!0,r||(v=ct(t,"click",o[3]),r=!0)},p(c,[a]){h&&h.p&&(!s||a&2)&&se(h,u,c,c[1],s?ae(u,c[1],a,null):ce(c[1]),null),(!s||a&1&&i!==(i="button "+c[0]+" svelte-1x4k1pl"))&&F(t,"class",i)},i(c){s||(z(h,c),s=!0)},o(c){L(h,c),s=!1},d(c){c&&J(t),h&&h.d(c),r=!1,v()}}}function we(o,t,i){let{$$slots:s={},$$scope:r}=t,{colour:v="green"}=t;function u(h){ye.call(this,o,h)}return o.$$set=h=>{"colour"in h&&i(0,v=h.colour),"$$scope"in h&&i(1,r=h.$$scope)},[v,r,s,u]}class wt extends pt{constructor(t){super(),dt(this,t,we,me,ot,{colour:0})}}const Ot=o=>{switch(o){case"Curse":return"#DC77FF";case"Deck":return"#8995D5";case"Movement":return"#FDFF84";case"Change":return"#FFA944";case"Mystery":return"#F35555";case"Board":return"#88F355";default:return"#FFFFFF"}},xt=o=>`${o}.svg`,Pt=o=>{const t=Math.random().toString(36);return o===1?{id:t,cardHalf1:{cardType:{passive:!1,type:"Mystery"},text:"placeholder"},cardHalf2:void 0}:{id:t,cardHalf1:{cardType:{passive:!0,type:"Deck"},text:"placeholder"},cardHalf2:{cardType:{passive:!1,type:"Movement"},text:"placeholder"}}};function Te(o){let t,i,s,r,v;return{c(){t=R("div"),i=R("div"),s=R("div"),F(s,"contenteditable","true"),F(s,"class","cardText svelte-2sj25y"),o[0].text===void 0&&bt(()=>o[3].call(s)),F(i,"class","card svelte-2sj25y"),et(i,"--colour",o[2]),F(t,"class","wrapper svelte-2sj25y"),et(t,"--rotation",o[1]+"deg")},m(u,h){q(u,t,h),X(t,i),X(i,s),o[0].text!==void 0&&(s.innerText=o[0].text),r||(v=ct(s,"input",o[3]),r=!0)},p(u,[h]){h&1&&u[0].text!==s.innerText&&(s.innerText=u[0].text),h&4&&et(i,"--colour",u[2]),h&2&&et(t,"--rotation",u[1]+"deg")},i:tt,o:tt,d(u){u&&J(t),r=!1,v()}}}function je(o,t,i){let s,{card:r}=t,{rotation:v=0}=t;function u(){r.text=this.innerText,i(0,r)}return o.$$set=h=>{"card"in h&&i(0,r=h.card),"rotation"in h&&i(1,v=h.rotation)},o.$$.update=()=>{o.$$.dirty&1&&i(2,s=Ot(r.cardType.type))},[r,v,s,u]}class Ft extends pt{constructor(t){super(),dt(this,t,je,Te,ot,{card:0,rotation:1})}}function Jt(o,t,i){const s=o.slice();return s[10]=t[i],s}function qt(o){let t,i=St(o[2]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Wt(Jt(o,i,r));return{c(){t=R("div");for(let r=0;r<s.length;r+=1)s[r].c();F(t,"class","options svelte-lm5vvd"),et(t,"--colour",o[4])},m(r,v){q(r,t,v);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(t,null)},p(r,v){if(v&13){i=St(r[2]);let u;for(u=0;u<i.length;u+=1){const h=Jt(r,i,u);s[u]?s[u].p(h,v):(s[u]=Wt(h),s[u].c(),s[u].m(t,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}v&16&&et(t,"--colour",r[4])},d(r){r&&J(t),Qt(s,r)}}}function Wt(o){let t,i,s,r,v;function u(){return o[7](o[10])}return{c(){t=R("img"),jt(t.src,i=xt(o[10]))||F(t,"src",i),F(t,"alt","My Icon"),F(t,"class",s="cardIcon "+(o[0]===o[10]?"hidden":"")+" svelte-lm5vvd")},m(h,c){q(h,t,c),r||(v=ct(t,"click",u),r=!0)},p(h,c){o=h,c&4&&!jt(t.src,i=xt(o[10]))&&F(t,"src",i),c&5&&s!==(s="cardIcon "+(o[0]===o[10]?"hidden":"")+" svelte-lm5vvd")&&F(t,"class",s)},d(h){h&&J(t),r=!1,v()}}}function Se(o){let t,i,s,r,v,u,h,c,a,l,f,w,$=o[3]&&qt(o);return{c(){t=R("div"),i=R("img"),r=K(),$&&$.c(),v=K(),u=R("input"),h=K(),c=R("label"),a=ht("Passive"),jt(i.src,s=xt(o[0]))||F(i,"src",s),F(i,"alt","My Icon"),F(i,"class","cardIcon svelte-lm5vvd"),F(t,"class","select svelte-lm5vvd"),F(u,"type","checkbox"),F(u,"id",o[5]),F(u,"class","hidden"),F(c,"for",o[5]),F(c,"class",l="passive no-select "+(o[1]?"":"invisible")+" svelte-lm5vvd")},m(p,b){q(p,t,b),X(t,i),X(t,r),$&&$.m(t,null),q(p,v,b),q(p,u,b),u.checked=o[1],q(p,h,b),q(p,c,b),X(c,a),f||(w=[ct(i,"click",o[6]),ct(u,"change",o[8])],f=!0)},p(p,[b]){b&1&&!jt(i.src,s=xt(p[0]))&&F(i,"src",s),p[3]?$?$.p(p,b):($=qt(p),$.c(),$.m(t,null)):$&&($.d(1),$=null),b&2&&(u.checked=p[1]),b&2&&l!==(l="passive no-select "+(p[1]?"":"invisible")+" svelte-lm5vvd")&&F(c,"class",l)},i:tt,o:tt,d(p){p&&(J(t),J(v),J(u),J(h),J(c)),$&&$.d(),f=!1,lt(w)}}}function Oe(o,t,i){let s,{cardType:r}=t,{passive:v=!1}=t;const u=Math.random().toString(36).substring(7),h=pe();let c=!1,{names:a=["Board","Change","Deck","Movement","Mystery","Curse"]}=t;const l=()=>i(3,c=!c),f=$=>{i(0,r=$),i(3,c=!1)};function w(){v=this.checked,i(1,v)}return o.$$set=$=>{"cardType"in $&&i(0,r=$.cardType),"passive"in $&&i(1,v=$.passive),"names"in $&&i(2,a=$.names)},o.$$.update=()=>{o.$$.dirty&1&&i(4,s=Ot(r)),o.$$.dirty&1&&h("type",r),o.$$.dirty&2&&h("passive",v)},[r,v,a,c,s,u,l,f,w]}class Nt extends pt{constructor(t){super(),dt(this,t,Oe,Se,ot,{cardType:0,passive:1,names:2})}}function xe(o){let t,i,s,r,v,u,h,c;return s=new Nt({props:{cardType:o[0].cardType.type,passive:o[0].cardType.passive,names:["Mystery","Curse"]}}),s.$on("type",o[1]),{c(){t=R("div"),i=R("p"),Z(s.$$.fragment),r=K(),v=R("div"),F(i,"class","svelte-1xn06xl"),F(v,"contenteditable","true"),F(v,"class","cardText svelte-1xn06xl"),o[0].text===void 0&&bt(()=>o[2].call(v)),F(t,"class","card svelte-1xn06xl"),et(t,"--colour",Ot(o[0].cardType.type))},m(a,l){q(a,t,l),X(t,i),V(s,i,null),X(t,r),X(t,v),o[0].text!==void 0&&(v.innerText=o[0].text),u=!0,h||(c=ct(v,"input",o[2]),h=!0)},p(a,[l]){const f={};l&1&&(f.cardType=a[0].cardType.type),l&1&&(f.passive=a[0].cardType.passive),s.$set(f),l&1&&a[0].text!==v.innerText&&(v.innerText=a[0].text),(!u||l&1)&&et(t,"--colour",Ot(a[0].cardType.type))},i(a){u||(z(s.$$.fragment,a),u=!0)},o(a){L(s.$$.fragment,a),u=!1},d(a){a&&J(t),Q(s),h=!1,c()}}}function De(o,t,i){let{card:s}=t;const r=({detail:u})=>i(0,s.cardType.type=u,s);function v(){s.text=this.innerText,i(0,s)}return o.$$set=u=>{"card"in u&&i(0,s=u.card)},[s,r,v]}class Ae extends pt{constructor(t){super(),dt(this,t,De,xe,ot,{card:0})}}function Ge(o){let t,i;return t=new Ae({props:{card:o[0].cardHalf1}}),{c(){Z(t.$$.fragment)},m(s,r){V(t,s,r),i=!0},p(s,r){const v={};r&1&&(v.card=s[0].cardHalf1),t.$set(v)},i(s){i||(z(t.$$.fragment,s),i=!0)},o(s){L(t.$$.fragment,s),i=!1},d(s){Q(t,s)}}}function Ne(o){let t,i,s,r,v,u,h,c,a,l;return i=new Nt({props:{cardType:o[0].cardHalf1.cardType.type,passive:o[0].cardHalf1.cardType.passive}}),i.$on("type",o[1]),i.$on("passive",o[2]),r=new Ft({props:{card:o[0].cardHalf1}}),u=new Ft({props:{card:o[0].cardHalf2,rotation:180}}),a=new Nt({props:{cardType:o[0].cardHalf2.cardType.type,passive:o[0].cardHalf2.cardType.passive}}),a.$on("type",o[3]),a.$on("passive",o[4]),{c(){t=R("p"),Z(i.$$.fragment),s=K(),Z(r.$$.fragment),v=K(),Z(u.$$.fragment),h=K(),c=R("p"),Z(a.$$.fragment),F(t,"class","first svelte-btssnq"),F(c,"class","second svelte-btssnq")},m(f,w){q(f,t,w),V(i,t,null),q(f,s,w),V(r,f,w),q(f,v,w),V(u,f,w),q(f,h,w),q(f,c,w),V(a,c,null),l=!0},p(f,w){const $={};w&1&&($.cardType=f[0].cardHalf1.cardType.type),w&1&&($.passive=f[0].cardHalf1.cardType.passive),i.$set($);const p={};w&1&&(p.card=f[0].cardHalf1),r.$set(p);const b={};w&1&&(b.card=f[0].cardHalf2),u.$set(b);const g={};w&1&&(g.cardType=f[0].cardHalf2.cardType.type),w&1&&(g.passive=f[0].cardHalf2.cardType.passive),a.$set(g)},i(f){l||(z(i.$$.fragment,f),z(r.$$.fragment,f),z(u.$$.fragment,f),z(a.$$.fragment,f),l=!0)},o(f){L(i.$$.fragment,f),L(r.$$.fragment,f),L(u.$$.fragment,f),L(a.$$.fragment,f),l=!1},d(f){f&&(J(t),J(s),J(v),J(h),J(c)),Q(i),Q(r,f),Q(u,f),Q(a)}}}function Ee(o){let t,i,s,r;const v=[Ne,Ge],u=[];function h(c,a){return c[0].cardHalf2?0:1}return i=h(o),s=u[i]=v[i](o),{c(){t=R("div"),s.c(),F(t,"class","card svelte-btssnq")},m(c,a){q(c,t,a),u[i].m(t,null),r=!0},p(c,[a]){let l=i;i=h(c),i===l?u[i].p(c,a):(Yt(),L(u[l],1,1,()=>{u[l]=null}),Zt(),s=u[i],s?s.p(c,a):(s=u[i]=v[i](c),s.c()),z(s,1),s.m(t,null))},i(c){r||(z(s),r=!0)},o(c){L(s),r=!1},d(c){c&&J(t),u[i].d()}}}function Ie(o,t,i){let{card:s}=t;const r=({detail:c})=>i(0,s.cardHalf1.cardType.type=c,s),v=({detail:c})=>i(0,s.cardHalf1.cardType.passive=c,s),u=({detail:c})=>{s.cardHalf2&&i(0,s.cardHalf2.cardType.type=c,s)},h=({detail:c})=>{s.cardHalf2&&i(0,s.cardHalf2.cardType.passive=c,s)};return o.$$set=c=>{"card"in c&&i(0,s=c.card)},[s,r,v,u,h]}class Ce extends pt{constructor(t){super(),dt(this,t,Ie,Ee,ot,{card:0})}}function Me(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Be(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Et={exports:{}};Et.exports;(function(o){(function(){function t(s,r){return r?Be(s):s.slice?t[v(s)]:function(u,h){s(u={exports:{}}),t[v(h)]=u.exports};function v(u){return u.split("/").slice(-1).toString().replace(".js","")}}var i=o;t(function(s){String.random=function(v,u){var h="";for(v=v||24,u=u||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";v-- >0;)h+=u.charAt(Math.floor(Math.random()*u.length));return h},String.match=function(v,u){var h,c;return typeof v!="string"?!1:(typeof u=="string"&&(u={"=":u}),u=u||{},h=u["="]||u["*"]||u[">"]||u["<"],v===h?!0:c!==u["="]?!1:(h=u["*"]||u[">"],v.slice(0,(h||"").length)===h?!0:c!==u["*"]?!1:c!==u[">"]&&c!==u["<"]?v>=u[">"]&&v<=u["<"]:c!==u[">"]&&v>=u[">"]||c!==u["<"]&&v<=u["<"]))},String.hash=function(v,u){if(typeof v=="string"){if(u=u||0,!v.length)return u;for(var h=0,c=v.length,a;h<c;++h)a=v.charCodeAt(h),u=(u<<5)-u+a,u|=0;return u}};var r=Object.prototype.hasOwnProperty;Object.plain=function(v){return v?v instanceof Object&&v.constructor===Object||Object.prototype.toString.call(v).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(v,u){for(var h in v)if(r.call(v,h)&&(!u||u.indexOf(h)==-1))return!1;return!0},Object.keys=Object.keys||function(v){var u=[];for(var h in v)r.call(v,h)&&u.push(h);return u},function(){var v,u=setTimeout,h=0,c=0,a=typeof setImmediate!=""+v&&setImmediate||function(f,w){return typeof MessageChannel==""+v?u:((f=new MessageChannel).port1.onmessage=function($){$.data==""&&w()},function($){w=$,f.port2.postMessage("")})}(),l=u.check=u.check||typeof performance!=""+v&&performance||{now:function(){return+new Date}};u.hold=u.hold||9,u.poll=u.poll||function(f){if(u.hold>=l.now()-h&&c++<3333){f();return}a(function(){h=l.now(),f()},c=0)}}(),function(){var v=setTimeout,u=v.turn=v.turn||function(w){h.push(w)==1&&c(f)},h=u.s=[],c=v.poll,a=0,l,f=function(){(l=h[a++])&&l(),(a==h.length||a==99)&&(h=u.s=h.slice(a),a=0),h.length&&c(f)}}(),function(){var v,u=setTimeout,h=u.turn;(u.each=u.each||function(c,a,l,f){f=f||9,function w($,p,b){if(p=($=(c||[]).splice(0,f)).length){for(var g=0;g<p&&v===(b=a($[g]));g++);if(v===b){h(w);return}}l&&l(b)}()})()}()})(t,"./shim"),t(function(s){s.exports=function r(l,u,h){if(!l)return{to:r};var c,a=typeof u=="function",l=(this.tag||(this.tag={}))[l]||a&&(this.tag[l]={tag:l,to:r._={next:function(w){var $;($=this.to)&&$.next(w)}}});if(a){var f={off:r.off||(r.off=function(){if(this.next===r._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=r._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:r._,next:u,the:l,on:this,as:h};return(f.back=l.last||l).to=f,l.last=f}return(l=l.to)&&c!==u&&l.next(u),l}})(t,"./onto"),t(function(s){s.exports=function(r){return r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"&&r!=1/0&&r!=-1/0&&r===r||!!r&&typeof r["#"]=="string"&&Object.keys(r).length===1&&r["#"]}})(t,"./valid"),t(function(s){t("./shim");function r(){var l=+new Date;return c<l?(u=0,c=l+r.drift):c=l+(u+=1)/h+r.drift}r.drift=0;var v=-1/0,u=0,h=999,c=v,a;r.is=function(l,f,w){var $=f&&l&&l._&&l._[">"]||w;if($)return typeof($=$[f])=="number"?$:v},r.ify=function(l,f,w,$,p){(l=l||{})._=l._||{},p&&(l._["#"]=p);var b=l._[">"]||(l._[">"]={});return a!==f&&f!=="_"&&(typeof w=="number"&&(b[f]=w),a!==$&&(l[f]=$)),l},s.exports=r})(t,"./state"),t(function(s){t("./shim");function r(v){var u={s:{}},h=u.s;v=v||{max:999,age:1e3*9},u.check=function(a){return h[a]?c(a):!1};var c=u.track=function(a){var l=h[a]||(h[a]={});return l.was=u.now=+new Date,u.to||(u.to=setTimeout(u.drop,v.age+9)),c.ed&&c.ed(a),l};return u.drop=function(a){u.to=null,u.now=+new Date;var l=Object.keys(h);console.STAT&&console.STAT(u.now,+new Date-u.now,"dup drop keys"),setTimeout.each(l,function(f){var w=h[f];w&&(a||v.age)>u.now-w.was||delete h[f]},0,99)},u}s.exports=r})(t,"./dup"),t(function(s){t("./onto"),s.exports=function(u,h){if(this.on){var c=(this.opt||{}).lack||9e3;if(typeof u!="function"){if(!u)return;var l=u["#"]||u,a=(this.tag||"")[l];return a?(h&&(a=this.on(l,h),clearTimeout(a.err),a.err=setTimeout(function(){a.off()},c)),!0):void 0}var l=h&&h["#"]||r(9);if(!u)return l;var f=this.on(l,u,h);return f.err=f.err||setTimeout(function(){f.off(),f.next({err:"Error: No ACK yet.",lack:!0})},c),l}};var r=String.random||function(){return Math.random().toString(36).slice(2)}})(t,"./ask"),t(function(s){function r(p){return p instanceof r?(this._={$:this}).$:this instanceof r?r.create(this._={$:this,opt:p}):new r(p)}r.is=function(p){return p instanceof r||p&&p._&&p===p._.$||!1},r.version=.202,r.chain=r.prototype,r.chain.toJSON=function(){},t("./shim"),r.valid=t("./valid"),r.state=t("./state"),r.on=t("./onto"),r.dup=t("./dup"),r.ask=t("./ask"),function(){r.create=function(e){e.root=e.root||e,e.graph=e.graph||{},e.on=e.on||r.on,e.ask=e.ask||r.ask,e.dup=e.dup||r.dup();var _=e.$.opt(e.opt);return e.once||(e.on("in",p,e),e.on("out",p,e),e.on("put",D,e),r.on("create",e),e.on("create",e)),e.once=1,_};function p(e){if(e){if(e.out===p){this.to.next(e);return}var _=this,m=_.as,E=m.at||m,G=E.$,S=E.dup,N,M=e.DBG;if((N=e["#"])||(N=e["#"]=u(9)),!S.check(N)){if(S.track(N),N=e._,e._=typeof N=="function"?N:function(){},e.$&&e.$===(e.$._||"").$||(e.$=G),e["@"]&&!e.put&&n(e),!E.ask(e["@"],e))if(M&&(M.u=+new Date),e.put){b(e);return}else e.get&&r.on.get(e,G);M&&(M.uc=+new Date),_.to.next(e),M&&(M.ua=+new Date),!(e.nts||e.NTS)&&(e.out=p,E.on("out",e),M&&(M.ue=+new Date))}}}function b(e){if(e){var _=e._||"",m=_.root=((_.$=e.$||"")._||"").root;if(e["@"]&&_.faith&&!_.miss){e.out=p,m.on("out",e);return}_.latch=m.hatch,_.match=m.hatch=[];var E=e.put,G=_.DBG=e.DBG,S=+new Date;if(I=I||S,!(E["#"]&&E["."])){G&&(G.p=S),_["#"]=e["#"],_.msg=e,_.all=0,_.stun=1;var N=Object.keys(E);console.STAT&&console.STAT(S,((G||_).pk=+new Date)-S,"put sort");var M=0,B,H,P,W,U,Y,yt;(function nt(gt){if(B!=M){if(B=M,!(P=N[M])){console.STAT&&console.STAT(S,((G||_).pd=+new Date)-S,"put"),j(_);return}(W=E[P])?(yt=W._)?P!==yt["#"]?Y=T+x(P)+"soul not same.":(U=yt[">"])||(Y=T+x(P)+"no state."):Y=T+x(P)+"no meta.":Y=T+x(P)+"no node.",H=Object.keys(W||{})}if(Y){e.err=_.err=Y,j(_);return}var It=0,rt;for(gt=gt||0;gt++<9&&(rt=H[It++]);)if(rt!=="_"){var kt=W[rt],Ct=U[rt];if(f===Ct){Y=T+x(rt)+"on"+x(P)+"no state.";break}if(!c(kt)){Y=T+x(rt)+"on"+x(P)+"bad "+typeof kt+x(kt);break}g(kt,rt,P,Ct,e),++C}if((H=H.slice(It)).length){h(nt);return}++M,H=null,nt(gt)})()}}}r.on.put=b;function g(e,_,m,E,G){var S=G._||"",N=S.root,M=N.graph,B,H=M[m]||w,P=a(H,_,1),W=H[_],U=S.DBG;(B=console.STAT)&&(!M[m]||!W)&&(B.has=(B.has||0)+1);var Y=A();if(E>Y){setTimeout(function(){g(e,_,m,E,G)},(B=E-Y)>O?O:B),console.STAT&&console.STAT((U||S).Hf=+new Date,B,"future");return}if(!(E<P)&&!(!S.faith&&E===P&&(e===W||k(e)<=k(W))&&!S.miss)){S.stun++;var yt=G["#"]+S.all++,nt={toString:function(){return yt},_:S};nt.toJSON=nt.toString,N.dup.track(nt)["#"]=G["#"],U&&(U.ph=U.ph||+new Date),N.on("put",{"#":nt,"@":G["@"],put:{"#":m,".":_,":":e,">":E},ok:G.ok,_:S})}}function D(e){var _;(_=(e._||"").DBG)&&(_.pa=+new Date,_.pm=_.pm||+new Date);var m=this,E=m.as,G=E.graph,S=e._,N=e.put,M=N["#"],B=N["."],H=N[":"],P=N[">"];e["#"];var W;(W=S.msg)&&(W=W.put)&&(W=W[M])&&l(W,B,P,H,M),G[M]=l(G[M],B,P,H,M),(W=(E.next||"")[M])&&W.on("in",e),j(S),m.to.next(e)}function j(e,_){var m;if(!e.stop&&!(!e.err&&0<--e.stun)&&(e.stop=1,!!(m=e.root))){var E=e.match;E.end=1,E===m.hatch&&(!(E=e.latch)||E.end?delete m.hatch:m.hatch=E),e.hatch&&e.hatch(),setTimeout.each(e.match,function(G){G&&G()}),!(!(_=e.msg)||e.err||_.err)&&(_.out=p,e.root.on("out",_),d())}}function n(e){var _=e["@"]||"",m;if(!(m=_._)){var E=(E=e.$)&&(E=E._)&&(E=E.root)&&(E=E.dup);if(!(E=E.check(_)))return;e["@"]=E["#"]||e["@"];return}m.acks=(m.acks||0)+1,(m.err=e.err)&&(e["@"]=m["#"],j(m)),m.ok=e.ok||m.ok,!m.stop&&!m.crack&&(m.crack=m.match&&m.match.push(function(){y(m)})),y(m)}function y(e){!e||!e.root||e.stun||e.acks!==e.all||e.root.on("in",{"@":e["#"],err:e.err,ok:e.err?f:e.ok||{"":1}})}var T="Error: Invalid graph!",x=function(e){return" '"+(""+e).slice(0,9)+"...' "},k=JSON.stringify,O=2147483647,A=r.state,C=0,I,d=function(){C>999&&C/-(I-(I=+new Date))>1&&(r.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),d=function(){C=0})}}(),function(){r.on.get=function(b,g){var D=g._,j=b.get,n=j["#"],y=D.graph[n],T=j["."],x=D.next||(D.next={}),k=x[n],O=b._||{},A=O.DBG=b.DBG;if(A&&(A.g=+new Date),!y)return D.on("get",b);if(T){if((typeof T!="string"||f===y[T])&&!((k||"").next||"")[T]){D.on("get",b);return}y=l({},T,a(y,T),y[T],n)}y&&p(b,y),D.on("get",b)};function p(b,g){var D=+new Date,j=b._||{},n=j.DBG=b.DBG,y=b["#"],T=u(9),x=Object.keys(g||"").sort(),k=((g||"")._||"")["#"];x.length;var O=b.$._.root,A=g===O.graph[k];console.STAT&&console.STAT(D,((n||j).gk=+new Date)-D,"got keys"),g&&function C(){D=+new Date;for(var I=0,d,e={},_;I<9&&(d=x[I++]);)l(e,d,a(g,d),g[d],k);x=x.slice(I),(_={})[k]=e,e=_;var m;A&&(m=function(){},m.ram=m.faith=!0),_=x.length,console.STAT&&console.STAT(D,-(D-(D=+new Date)),"got copied some"),n&&(n.ga=+new Date),O.on("in",{"@":y,"#":T,put:e,"%":_?T=u(9):f,$:O.$,_:m,DBG:n,FOO:1}),console.STAT&&console.STAT(D,+new Date-D,"got in"),_&&setTimeout.turn(C)}(),g||O.on("in",{"@":b["#"]})}r.on.get.ack=p}(),function(){r.chain.opt=function(p){p=p||{};var b=this,g=b._,D=p.peers||p;return Object.plain(p)||(p={}),Object.plain(g.opt)||(g.opt=p),typeof D=="string"&&(D=[D]),Object.plain(g.opt.peers)||(g.opt.peers={}),D instanceof Array&&(p.peers={},D.forEach(function(j){var n={};n.id=n.url=j,p.peers[j]=g.opt.peers[j]=g.opt.peers[j]||n})),v(p,function j(n){var y=this[n];if(this&&this.hasOwnProperty(n)||typeof y=="string"||Object.empty(y)){this[n]=y;return}y&&y.constructor!==Object&&!(y instanceof Array)||v(y,j)}),g.opt.from=p,r.on("opt",g),g.opt.uuid=g.opt.uuid||function(n){return r.state().toString(36).replace(".","")+String.random(n||12)},b}}();var v=function(p,b){Object.keys(p).forEach(b,p)},u=String.random,h=setTimeout.turn,c=r.valid,a=r.state.is,l=r.state.ify,f,w={},$;r.log=function(){return!r.log.off&&$.log.apply($,arguments),[].slice.call(arguments).join(" ")},r.log.once=function(p,b,g){return(g=r.log.once)[p]=g[p]||0,g[p]++||r.log(b)},typeof window<"u"&&((window.GUN=window.Gun=r).window=window);try{typeof i<"u"&&(i.exports=r)}catch{}s.exports=r,(r.window||{}).console=(r.window||{}).console||{log:function(){}},($=console).only=function(p,b){return $.only.i&&p===$.only.i&&$.only.i++&&($.log.apply($,arguments)||b)},r.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(t,"./root"),t(function(s){var r=t("./root");r.chain.back=function(h,c){var a;if(h=h||1,h===-1||h===1/0)return this._.root.$;if(h===1)return(this._.back||this._).$;var l=this,f=l._;if(typeof h=="string"&&(h=h.split(".")),h instanceof Array){var w=0,$=h.length,a=f;for(w;w<$;w++)a=(a||v)[h[w]];return u!==a?c?l:a:(a=f.back)?a.$.back(h,c):void 0}if(typeof h=="function"){for(var p,a={back:f};(a=a.back)&&u===(p=h(a,c)););return p}return typeof h=="number"?(f.back||f).$.back(h-1):this};var v={},u})(t,"./back"),t(function(s){var r=t("./root");r.chain.chain=function(j){var n=this,y=n._,T=new(j||n).constructor(n),x=T._,k;return x.root=k=y.root,x.id=++k.once,x.back=n._,x.on=r.on,x.on("in",r.on.in,x),x.on("out",r.on.out,x),T};function v(j){var n,y=this.as,T=y.back,x=y.root,k;if(j.$||(j.$=y.$),this.to.next(j),y.err){y.on("in",{put:y.put=f,$:y.$});return}if(n=j.get){if(x.pass&&(x.pass[y.id]=y),y.lex&&Object.keys(y.lex).forEach(function(O){k[O]=y.lex[O]},k=j.get=j.get||{}),n["#"]||y.soul){if(n["#"]=n["#"]||y.soul,j["#"]||(j["#"]=w(9)),T=x.$.get(n["#"])._,n=n["."]){if(p(T.put,n)&&(k=T.ask&&T.ask[n],(T.ask||(T.ask={}))[n]=T.$.get(n)._,T.on("in",{get:n,put:{"#":T.soul,".":n,":":T.put[n],">":g(x.graph[T.soul],n)}}),k))return}else{if(k=T.ask&&T.ask[""],(T.ask||(T.ask={}))[""]=T,f!==T.put&&(T.on("in",T),k))return;j.$=T.$}return x.ask(a,j),x.on("in",j)}if(n["."])return y.get?(j={get:{".":y.get},$:y.$},(T.ask||(T.ask={}))[y.get]=j.$._,T.on("out",j)):(j={get:y.lex?j.get:{},$:y.$},T.on("out",j));if((y.ask||(y.ask={}))[""]=y,y.get)return n["."]=y.get,(T.ask||(T.ask={}))[y.get]=j.$._,T.on("out",j)}return T.on("out",j)}r.on.out=v;function u(j,n){n=n||this.as;var y=n.root,T=j.$||(j.$=n.$),x=(T||"")._||l,k=j.put||"",O=k["#"],A=k["."],C=f!==k["="]?k["="]:k[":"],I=k[">"]||-1/0,d;if(f!==j.put&&(f===k["#"]||f===k["."]||f===k[":"]&&f===k["="]||f===k[">"])){if(!$(k)){if(!(O=((k||"")._||"")["#"])){console.log("chain not yet supported for",k,"...",j,n);return}return T=n.root.$.get(O),setTimeout.each(Object.keys(k).sort(),function(e){e=="_"||f===(I=g(k,e))||n.on("in",{$:T,put:{"#":O,".":e,"=":k[e],">":I},VIA:j})})}n.on("in",{$:x.back.$,put:{"#":O=x.back.soul,".":A=x.has||x.get,"=":k,">":g(x.back.put,A)},via:j});return}(j.seen||"")[n.id]||((j.seen||(j.seen=function(){}))[n.id]=n,n!==x&&(Object.keys(j).forEach(function(e){k[e]=j[e]},k={}),k.get=n.get||k.get,!n.soul&&!n.has?k.$$$=k.$$$||n.$:x.soul&&(k.$=n.$,k.$$=k.$$||x.$),j=k),c(j,n),(n.soul||j.$$)&&I>=g(y.graph[O],A)&&((k=y.$.get(O)._).put=D(k.put,A,I,C,O)),!x.soul&&I>=g(y.graph[O],A)&&(d=(y.$.get(O)._.next||"")[A])&&(d.put=C,typeof(k=$(C))=="string"&&(d.put=y.$.get(k)._.put||C)),this.to&&this.to.next(j),n.any&&setTimeout.each(Object.keys(n.any),function(e){(e=n.any[e])&&e(j)},0,99),n.echo&&setTimeout.each(Object.keys(n.echo),function(e){(e=n.echo[e])&&e.on("in",j)},0,99),((j.$$||"")._||x).soul&&(d=n.next)&&(d=d[A])&&(k={},Object.keys(j).forEach(function(e){k[e]=j[e]}),k.$=(j.$$||j.$).get(k.get=A),delete k.$$,delete k.$$$,d.on("in",k)),h(j,n))}r.on.in=u;function h(j,n){if(n=n||this.as||j.$._,!(j.$$&&this!==r.on)&&!(!j.put||n.soul)){var y=j.put||"",T=y["="]||y[":"],A,x=n.root,k=x.$.get(y["#"]).get(y["."])._;if(typeof(T=$(T))!="string"){this===r.on&&((k.echo||(k.echo={}))[n.id]=n);return}if(!((k.echo||(k.echo={}))[n.id]&&!(x.pass||"")[n.id])){if(A=x.pass){if(A[T+n.id])return;A[T+n.id]=1}(k.echo||(k.echo={}))[n.id]=n,n.has&&(n.link=T);var O=x.$.get(k.link=T)._;(O.echo||(O.echo={}))[k.id]=k;var A=n.ask||"";(A[""]||n.lex)&&O.on("out",{get:{"#":T}}),setTimeout.each(Object.keys(A),function(C,I){!C||!(I=A[C])||I.on("out",{get:{"#":T,".":C}})},0,99)}}}r.on.link=h;function c(j,n){var y=j.put||"",T=f!==y["="]?y["="]:y[":"],x=n.root,k,O;if(f===T){if(n.soul&&f!==n.put||(O=(j.$$||j.$||"")._||"",j["@"]&&(f!==O.put||f!==n.put)))return;(k=n.link||j.linked)&&delete(x.$.get(k)._.echo||"")[n.id],n.has&&(n.link=null),n.put=f,setTimeout.each(Object.keys(n.next||""),function(A,C){(C=n.next[A])&&(k&&delete(x.$.get(k).get(A)._.echo||"")[C.id],C.on("in",{get:A,put:f,$:C.$}))},0,99);return}n.soul||j.$$||(k=$(T),O=j.$._||"",!((k===O.link||n.has&&!O.link)&&!((x.pass||"")[n.id]&&typeof k!="string"))&&(delete(O.echo||"")[n.id],c({get:n.get,put:f,$:j.$,linked:j.linked=j.linked||O.link},n)))}r.on.unlink=c;function a(j,n){var y=this.as,T=y.$._;T.root;var x=y.get||"",k=(j.put||"")[x["#"]]||"";if(!j.put||typeof x["."]=="string"&&f===k[x["."]]){if(f!==T.put||!T.soul&&!T.has)return;T.ack=(T.ack||0)+1,T.on("in",{get:T.get,put:T.put=f,$:T.$,"@":j["@"]});return}(j._||{}).miss=1,r.on.put(j)}var l={},f,w=String.random,$=r.valid,p=function(j,n){return j&&Object.prototype.hasOwnProperty.call(j,n)},b=r.state,g=b.is,D=b.ify})(t,"./chain"),t(function(s){var r=t("./root");r.chain.get=function(f,w,$){var p,b;if(typeof f=="string"){if(f.length==0)return(p=this.chain())._.err={err:r.log("0 length key!",f)},w&&w.call(p,p._.err),p;var g=this,D=g._,j=D.next||c;(p=j[f])||(p=f&&v(f,g)),p=p&&p.$}else if(typeof f=="function"){let A=function(C,I,d){if(!A.stun&&!((S=y.pass)&&!S[T])){var e=C.$._,_=(C.$$||"")._,m=(_||e).put,E=!e.has&&!e.soul,G={},S;if((E||l===m)&&(m=l===((S=C.put)||"")["="]?l===(S||"")[":"]?S:S[":"]:S["="]),typeof(S=r.valid(m))=="string"&&(m=l===(S=y.$.get(S)._.put)?n.not?l:m:S),!(n.not&&l===m)){if(l===n.stun){if((S=y.stun)&&S.on&&(D.$.back(function(N){if(S.on(""+N.id,G={}),(G.run||0)<A.id)return G}),!G.run&&S.on(""+e.id,G={}),!G.run&&_&&S.on(""+_.id,G={}),A.id>G.run&&((!G.stun||G.stun.end)&&(G.stun=S.on("stun"),G.stun=G.stun&&G.stun.last),G.stun&&!G.stun.end))){(G.stun.add||(G.stun.add={}))[T]=function(){A(C,I,1)};return}if(l===m&&(d=0),(S=y.hatch)&&!S.end&&l===n.hatch&&!d){if(x[e.$._.id])return;x[e.$._.id]=1,S.push(function(){A(C,I,1)});return}x={}}if(y.pass){if(y.pass[T+e.id])return;y.pass[T+e.id]=1}if(n.on){n.ok.call(e.$,m,e.get,C,I||A);return}if(n.v2020){n.ok(C,I||A);return}Object.keys(C).forEach(function(N){S[N]=C[N]},S={}),C=S,C.put=m,n.ok.call(n.as,C,I||A)}}};var k=A;if(w===!0)return u(this,f,w,$),this;p=this;var D=p._,n=w||{},y=D.root,T;n.at=D,n.ok=f;var x={};return A.at=D,(D.any||(D.any={}))[T=String.random(7)]=A,A.off=function(){A.stun=1,D.any&&delete D.any[T]},A.rid=h,A.id=n.run||++y.once,b=y.pass,(y.pass={})[T]=1,n.out=n.out||{get:{}},D.on("out",n.out),y.pass=b,p}else{if(typeof f=="number")return this.get(""+f,w,$);if(typeof(b=a(f))=="string")return this.get(b,w,$);(b=this.get.next)&&(p=b(this,f))}return p?(w&&typeof w=="function"&&p.get(w,$),p):((p=this.chain())._.err={err:r.log("Invalid get request!",f)},w&&w.call(p,p._.err),p)};function v(f,w){var $=w._,p=$.next,b=w.chain(),g=b._;return p||(p=$.next={}),p[g.get=f]=g,w===$.root.$?g.soul=f:($.soul||$.has)&&(g.has=f),g}function u(f,w,$,p){var b=f._,g=0,D;return(D=b.soul||b.link)?w(D,p,b):b.jam?b.jam.push([w,p]):(b.jam=[[w,p]],f.get(function(n,y){if(!(l===n.put&&!b.root.opt.super&&(D=Object.keys(b.root.opt.peers).length)&&++g<=D)){y.rid(n);var T=(T=n.$)&&T._||{},x=0,k;for(D=b.jam,delete b.jam;k=D[x++];){var O=k[0];k=k[1],O&&O(T.link||T.soul||r.valid(n.put)||((n.put||{})._||{})["#"],k,n,y)}}},{out:{get:{".":!0}}}),f)}function h(f){var w=this.at||this.on;if(!f||w.soul||w.has)return this.off();if(f=(f=(f=f.$||f)._||f).id){w.map;var $;if(($=this.seen||(this.seen={}))[f])return!0;$[f]=!0}}var c={},a=r.valid,l})(t,"./get"),t(function(s){var r=t("./root");r.chain.put=function(p,b,g){var D=this,j=D._,n=j.root;g=g||{},g.root=j.root,g.run||(g.run=n.once),v(g,j.id),g.ack=g.ack||b,g.via=g.via||D,g.data=g.data||p,g.soul||(g.soul=j.soul||typeof b=="string"&&b);var y=g.state=g.state||r.state();return typeof p=="function"?(p(function(T){g.data=T,D.put(a,a,g)}),D):g.soul?(g.$=n.$.get(g.soul),g.todo=[{it:g.data,ref:g.$}],g.turn=g.turn||f,g.ran=g.ran||u,function T(){var x=g.todo,k=x.pop(),O=k.it;k.ref&&k.ref._.id;var A,C,I,d,e;if(v(g,k.ref),(d=k.todo)&&(C=d.pop(),O=O[C],d.length&&x.push(k)),C&&(x.path||(x.path=[])).push(C),!(A=w(O))&&!(e=r.is(O))){if(!Object.plain(O)){u.err(g,"Invalid data: "+c(O)+" at "+(g.via.back(function(S){S.get&&d.push(S.get)},d=[])||d.join("."))+"."+(x.path||[]).join("."));return}for(var _=g.seen||(g.seen=[]),m=_.length;m--;)if(O===(d=_[m]).it){A=O=d.link;break}}if(C&&A)k.node=$(k.node,C,y,O);else{let S=function(N,M){var B=I.link["#"];M&&(M.off(),M.rid(N));var H=B||N.soul||(d=(N.$$||N.$)._||"").soul||d.link||((d=d.put||"")._||"")["#"]||d["#"]||((d=N.put||"")&&N.$$?d["#"]:(d["="]||d[":"]||"")["#"]);if(!B&&v(g,N.$),!H&&!k.link["#"]){(k.wait||(k.wait=[])).push(function(){S(N,M)});return}H||(H=[],(N.$$||N.$).back(function(P){if(d=P.soul||P.link)return H.push(d);H.push(P.get)}),H=H.reverse().join("/")),I.link["#"]=H,!e&&(((g.graph||(g.graph={}))[H]=I.node||(I.node={_:{}}))._["#"]=H),delete g.wait[E],I.wait&&setTimeout.each(I.wait,function(P){P&&P()}),g.ran(g)};var G=S;if(!g.seen){u.err(g,"Data at root of graph must be a node (an object).");return}g.seen.push(I={it:O,link:{},todo:e?[]:Object.keys(O).sort().reverse(),path:(x.path||[]).slice(),up:k}),k.node=$(k.node,C,y,I.link),!e&&I.todo.length&&x.push(I);var E=g.seen.length;(g.wait||(g.wait={}))[E]="",d=(I.ref=e?O:C?k.ref.get(C):k.ref)._,(d=O&&(O._||"")["#"]||d.soul||d.link)?S({soul:d}):I.ref.get(S,{run:g.run,v2020:1,out:{get:{".":" "}}})}if(!x.length)return g.ran(g);g.turn(T)}(),D):(h(g),D)};function v(p,b){if(b){b=(b._||"").id||b;var g=p.root.stun||(p.root.stun={on:r.on}),D={},j;p.stun||(p.stun=g.on("stun",function(){})),(j=g.on(""+b))&&j.the.last.next(D),!(D.run>=p.run)&&g.on(""+b,function(n){if(p.stun.end){this.off(),this.to.next(n);return}n.run=n.run||p.run,n.stun=n.stun||p.stun})}}function u(p){if(p.err){u.end(p.stun,p.root);return}if(!(p.todo.length||p.end||!Object.empty(p.wait))){p.end=1;var b=p.$.back(-1)._,g=b.root,D=b.ask(function(T){g.on("ack",T),T.err&&!T.lack&&r.log(T),++j>(p.acks||0)&&this.off(),p.ack&&p.ack(T,this)},p.opt),j=0,n=p.stun,y;(y=function(){n&&(u.end(n,g),setTimeout.each(Object.keys(n=n.add||""),function(T){(T=n[T])&&T()}))}).hatch=y,p.ack&&!p.ok&&(p.ok=p.acks||9),p.via._.on("out",{put:p.out=p.graph,ok:p.ok&&{"@":p.ok+1},opt:p.opt,"#":D,_:y})}}u.end=function(p,b){p.end=l,p.the.to===p&&p===p.the.last&&delete b.stun,p.off()},u.err=function(p,b){(p.ack||l).call(p,p.out={err:p.err=r.log(b)}),p.ran(p)};function h(p){var b=p.via._,g;p.via=p.via.back(function(D){if(D.soul||!D.get)return D.$;g=p.data,(p.data={})[D.get]=g}),(!p.via||!p.via._.soul)&&(p.via=b.root.$.get(((p.data||"")._||"")["#"]||b.$.back("opt.uuid")())),p.via.put(p.data,p.ack,p)}function c(p,b){return p&&(b=p.constructor)&&b.name||typeof p}var a,l=function(){},f=setTimeout.turn,w=r.valid,$=r.state.ify})(t,"./put"),t(function(s){var r=t("./root");t("./chain"),t("./back"),t("./put"),t("./get"),s.exports=r})(t,"./index"),t(function(s){var r=t("./index");r.chain.on=function(h,c,a,l){var f=this,w=f._;w.root;var $;if(typeof h=="string")return c?($=w.on(h,c,a||w,l),a&&a.$&&(a.subs||(a.subs=[])).push($),f):w.on(h);var p=c;return(p=p===!0?{change:!0}:p||{}).not=1,p.on=1,f.get(h,p),f},r.chain.once=function(h,c){if(c=c||{},!h)return v(this);var a=this,l=a._,f=l.root;l.put;var w=String.random(7),$;return a.get(function(p,b,g,D){var j=this,n=j._,y=n.one||(n.one={});if(D.stun||y[w]==="")return;if(($=r.valid(p))===!0){T();return}if(typeof $=="string")return;clearTimeout((l.one||"")[w]),clearTimeout(y[w]),y[w]=setTimeout(T,c.wait||99);function T(x){if(!n.has&&!n.soul&&(n={put:p,get:b}),u===($=n.put)&&($=((g.$$||"")._||"").put),typeof r.valid($)=="string"&&($=f.$.get($)._.put,$===u&&!x)){y[w]=setTimeout(function(){T(1)},c.wait||99);return}D.stun||y[w]!==""&&(y[w]="",(l.soul||l.has)&&D.off(),h.call(j,$,n.get),clearTimeout(y[w]))}},{on:1}),a};function v(h,c,a){return r.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(a=h.chain())._.nix=h.once(function(l,f){a._.on("in",this._)}),a._.lex=h._.lex,a}r.chain.off=function(){var h=this,c=h._,a,l=c.back;if(l)return c.ack=0,(a=l.next)&&a[c.get]&&delete a[c.get],(a=l.any)&&(delete l.any,l.any={}),(a=l.ask)&&delete a[c.get],(a=l.put)&&delete a[c.get],(a=c.soul)&&delete l.root.graph[a],(a=c.map)&&Object.keys(a).forEach(function(f,w){w=a[f],w.link&&l.root.$.get(w.link).off()}),(a=c.next)&&Object.keys(a).forEach(function(f,w){w=a[f],w.$.off()}),c.on("off",{}),h};var u})(t,"./on"),t(function(s){var r=t("./index"),v=r.chain.get.next;r.chain.get.next=function(a,l){var f;return Object.plain(l)?(f=((f=l["#"])||"")["="]||f)?a.get(f):((f=a.chain()._).lex=l,a.on("in",function(w){String.match(w.get||(w.put||"")["."],l["."]||l["#"]||l)&&f.on("in",w),this.to.next(w)}),f.$):(v||h)(a,l)},r.chain.map=function(a,l,f){var w=this,$=w._,p,b;return Object.plain(a)&&(p=a["."]?a:{".":a},a=c),a?(r.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),b=w.chain(),w.map().on(function(g,D,j,n){var y=(a||h).call(this,g,D,j,n);if(c!==y){if(g===y)return b._.on("in",j);if(r.is(y))return b._.on("in",y._);var T={};Object.keys(j.put).forEach(function(x){T[x]=j.put[x]},T),T["="]=y,b._.on("in",{get:D,put:T})}}),b):((b=$.each)||(($.each=b=w.chain())._.lex=p||b._.lex||$.lex,b._.nix=w.back("nix"),w.on("in",u,b._)),b)};function u(a){this.to.next(a);var l=this.as,f=a.$,w=f._,$=a.put,p;!w.soul&&!a.$$||(p=l.lex)&&!String.match(a.get||($||"")["."],p["."]||p["#"]||p)||r.on.link(a,l)}var h=function(){},c})(t,"./map"),t(function(s){var r=t("./index");r.chain.set=function(v,u,h){var c=this,a=c.back(-1),l,f;return u=u||function(){},h=h||{},h.item=h.item||v,(l=((v||"")._||"")["#"])&&((v={})["#"]=l),typeof(f=r.valid(v))=="string"?c.get(l=f).put(v,u,h):r.is(v)?(c.put(function(w){v.get(function($,p,b){if(!$)return u.call(c,{err:r.log('Only a node can be linked! Not "'+b.put+'"!')});(f={})[$]={"#":$},w(f)},!0)}),v):(Object.plain(v)&&(v=a.get(l=c.back("opt.uuid")()).put(v)),c.get(l||a.back("opt.uuid")(7)).put(v,u,h))}})(t,"./set"),t(function(s){t("./shim");var r=function(){},v=JSON.parseAsync||function(a,l,f){var w,$=+new Date;try{l(w,JSON.parse(a,f),u.sucks(+new Date-$))}catch(p){l(p)}},u=JSON.stringifyAsync||function(a,l,f,w){var $,p=+new Date;try{l($,JSON.stringify(a,f,w),u.sucks(+new Date-p))}catch(b){l(b)}};u.sucks=function(a){a>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),u.sucks=r)};function h(a){var l=function(){},f=a.opt||{};f.log=f.log||console.log,f.gap=f.gap||f.wait||0,f.max=f.max||(f.memory?f.memory*999*999:3e8)*.3,f.pack=f.pack||f.max*.01*.01,f.puff=f.puff||9;var w=setTimeout.turn||setTimeout,$=a.dup,p=$.check,b=$.track,g=l.hear=function(n,y){if(n){if(f.max<=n.length)return l.say({dam:"!",err:"Message too big!"},y);l===this&&(g.d+=n.length||0,++g.c);var T=y.SH=+new Date,x=n[0],k;if(x==="["){v(n,function(O,A){if(O||!A)return l.say({dam:"!",err:"DAM JSON parse error."},y);console.STAT&&console.STAT(+new Date,A.length,"# on hear batch");var C=f.puff;(function I(){for(var d=+new Date,e=0,_;e<C&&(_=A[e++]);)l.hear(_,y);A=A.slice(e),console.STAT&&console.STAT(d,+new Date-d,"hear loop"),D(y),A.length&&w(I,0)})()}),n="";return}if(x==="{"||(n["#"]||Object.plain(n))&&(k=n)){if(k)return g.one(k,y,T);v(n,function(O,A){if(O||!A)return l.say({dam:"!",err:"DAM JSON parse error."},y);g.one(A,y,T)});return}}};g.one=function(n,y,I){var x,k,O,A,C;if(n.DBG&&(n.DBG=C={DBG:n.DBG}),C&&(C.h=I),C&&(C.hp=+new Date),(x=n["#"])||(x=n["#"]=String.random(9)),!(O=p(x))&&(k=n["##"],!(k&&(O=n["@"]||n.get&&x)&&$.check(A=O+k)))){if((n._=function(){}).via=l.leap=y,(O=n["><"])&&typeof O=="string"&&O.slice(0,99).split(",").forEach(function(d){this[d]=1},n._.yo={}),O=n.dam){(O=l.hear[O])&&O(n,y,a),b(x);return}(O=n.ok)&&(n._.near=O["/"]);var I=+new Date;C&&(C.is=I),y.SI=x,b.ed=function(d){x===d&&(b.ed=0,(d=$.s[x])&&(d.via=y,n.get&&(d.it=n)))},a.on("in",l.last=n),C&&(C.hd=+new Date),console.STAT&&console.STAT(I,+new Date-I,n.get?"msg get":n.put?"msg put":"msg"),b(x),A&&b(A),l.leap=l.last=null}},g.c=g.d=0,function(){var n=0,y;l.hash=function(k,O){var A,C,I,d=+new Date;u(k.put,function e(_,m){var E=(C||(C=I=m||"")).slice(0,32768);if(A=String.hash(E,A),C=C.slice(32768),C){w(e,0);return}console.STAT&&console.STAT(d,+new Date-d,"say json+hash"),k._.$put=I,k["##"]=A,l.say(k,O),delete k._.$put},T)};function T(k,O){var A;return O instanceof Object?(Object.keys(O).sort().forEach(x,{to:A={},on:O}),A):O}function x(k){this.to[k]=this.on[k]}l.say=function(k,O){var A;if((A=this)&&(A=A.to)&&A.next&&A.next(k),!k)return!1;var C,I,d,e=k["@"],_=k._||(k._=function(){}),m=k.DBG,E=+new Date;if(_.y=_.y||E,O||m&&(m.y=E),(C=k["#"])||(C=k["#"]=String.random(9)),!y&&b(C),!(I=k["##"])&&c!==k.put&&!_.via&&e){l.hash(k,O);return}if(!O&&e&&(O=(A=$.s[e])&&(A.via||(A=A.it)&&(A=A._)&&A.via)||(A=l.last)&&e===A["#"]&&l.leap),!O&&e)return $.s[e]?void 0:(console.STAT&&console.STAT(+new Date,++n,"total no peer to ack to"),!1);if(e&&!k.put&&!I&&(($.s[e]||"").it||"")["##"])return!1;if(!O&&l.way)return l.way(k);if(m&&(m.yh=+new Date),!(d=_.raw)){l.raw(k,O);return}if(m&&(m.yr=+new Date),!O||!O.id){if(!Object.plain(O||f.peers))return!1;var E=+new Date;f.puff;var G=f.peers,S=Object.keys(O||f.peers||{});console.STAT&&console.STAT(E,+new Date-E,"peer keys"),function B(){var H=+new Date;y=1;var P=_.raw;_.raw=d;for(var W=0,U;W<9&&(U=(S||"")[W++]);)(U=G[U]||(O||"")[U])&&l.say(k,U);_.raw=P,y=0,S=S.slice(W),console.STAT&&console.STAT(H,+new Date-H,"say loop"),S.length&&(w(B,0),e&&b(e))}();return}if(!O.wire&&l.wire&&l.wire(O),C!==O.last){if(O.last=C,O===_.via||(A=_.yo)&&(A[O.url]||A[O.pid]||A[O.id]))return!1;if(console.STAT&&console.STAT(E,((m||_).yp=+new Date)-(_.y||E),"say prep"),!y&&e&&b(e),O.batch){if(O.tail=(A=O.tail||0)+d.length,O.tail<=f.pack){O.batch+=(A?",":"")+d;return}D(O)}O.batch="[";var N=+new Date;setTimeout(function(){console.STAT&&console.STAT(N,+new Date-N,"0ms TO"),D(O)},f.gap),j(d,O),console.STAT&&e===O.SI&&console.STAT(E,+new Date-O.SH,"say ack")}},l.say.c=l.say.d=0,l.raw=function(k,O){if(!k)return"";var A=k._||{},C,I;if(I=A.raw)return I;if(typeof k=="string")return k;var d=k["##"],e=k["@"];if(d&&e){if(!A.via&&p(e+d))return!1;if(I=($.s[e]||"").it){if(d===I["##"])return!1;I["##"]||(I["##"]=d)}}if(!k.dam&&!k["@"]){var _=0,m=[];I=f.peers;for(var E in I){var G=I[E];if(m.push(G.url||G.pid||G.id),++_>6)break}_>1&&(k["><"]=m.join())}if(k.put&&(I=k.ok)&&(k.ok={"@":(I["@"]||1)-1,"/":I["/"]==k._.near?l.near:I["/"]}),C=A.$put){I={},Object.keys(k).forEach(function(N){I[N]=k[N]}),I.put=":])([:",u(I,function(N,M){if(!N){var B=+new Date;I=M.indexOf('"put":":])([:"'),S(c,M=M.slice(0,I+6)+C+M.slice(I+14)),console.STAT&&console.STAT(B,+new Date-B,"say slice")}});return}u(k,S);function S(N,M){N||(A.raw=M,l.say(k,O))}}}();function D(n){var y=n.batch,T=typeof y=="string";if(T&&(y+="]"),n.batch=n.tail=null,!!y&&!(T?3>y.length:!y.length)){if(!T)try{y=y.length===1?y[0]:JSON.stringify(y)}catch(x){return f.log("DAM JSON stringify error",x)}y&&j(y,n)}}function j(n,y){try{var T=y.wire;y.say?y.say(n):T.send&&T.send(n),l.say.d+=n.length||0,++l.say.c}catch{(y.queue=y.queue||[]).push(n)}}return l.near=0,l.hi=function(n){var y=n.wire,T;if(!y){l.wire(n.length&&{url:n,id:n}||n);return}n.id?f.peers[n.url||n.id]=n:(T=n.id=n.id||n.url||String.random(9),l.say({dam:"?",pid:a.opt.pid},f.peers[T]=n),delete $.s[n.last]),n.met||(l.near++,n.met=+new Date,a.on("hi",n)),T=n.queue,n.queue=[],setTimeout.each(T||[],function(x){j(x,n)},0,9)},l.bye=function(n){n.met&&--l.near,delete n.met,a.on("bye",n);var y=+new Date;y=y-(n.met||y),l.bye.time=((l.bye.time||y)+y)/2},l.hear["!"]=function(n,y){f.log("Error:",n.err)},l.hear["?"]=function(n,y){n.pid&&(y.pid||(y.pid=n.pid),n["@"])||(l.say({dam:"?",pid:f.pid,"@":n["#"]},y),delete $.s[y.last])},l.hear.mob=function(n,y){if(n.peers){var T=Object.keys(n.peers),x=T[Math.random()*T.length>>0];x&&(l.bye(y),l.hi(x))}},a.on("create",function(n){n.opt.pid=n.opt.pid||String.random(9),this.to.next(n),n.on("out",l.say)}),a.on("bye",function(n,y){n=f.peers[n.id||n]||n,this.to.next(n),n.bye?n.bye():(y=n.wire)&&y.close&&y.close(),delete f.peers[n.id],n.wire=null}),a.on("bye",function(n,y){this.to.next(n),(y=console.STAT)&&(y.peers=l.near),(y=n.url)&&setTimeout(function(){},f.lack||9e3)}),a.on("hi",function(n,y){if(this.to.next(n),(y=console.STAT)&&(y.peers=l.near),!f.super){var T=Object.keys(a.next||"");T.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(T,function(x){var k=a.next[x];if(f.super||(k.ask||"")[""]){l.say({get:{"#":x}},n);return}setTimeout.each(Object.keys(k.ask||""),function(O){O&&l.say({"##":String.hash((a.graph[x]||"")[O]),get:{"#":x,".":O}},n)})})}}),l}var c;try{s.exports=h}catch{}})(t,"./mesh"),t(function(s){var r=t("./index");r.Mesh=t("./mesh"),r.on("opt",function(u){if(this.to.next(u),u.once)return;var h=u.opt;if(h.WebSocket===!1)return;var c=r.window||{},a=h.WebSocket||c.WebSocket||c.webkitWebSocket||c.mozWebSocket;if(!a)return;h.WebSocket=a;var l=h.mesh=h.mesh||r.Mesh(u);l.wire||h.wire,l.wire=h.wire=f;function f(b){try{if(!b||!b.url)return D&&D(b);var g=b.url.replace(/^http/,"ws"),D=b.wire=new h.WebSocket(g);return D.onclose=function(){$(b),h.mesh.bye(b)},D.onerror=function(j){$(b)},D.onopen=function(){h.mesh.hi(b)},D.onmessage=function(j){j&&h.mesh.hear(j.data||j,b)},D}catch{h.mesh.bye(b)}}setTimeout(function(){!h.super&&u.on("out",{dam:"hi"})},1);var w=2*999;function $(b){clearTimeout(b.defer),h.peers[b.url]&&(p&&b.retry<=0||(b.retry=(b.retry||h.retry+1||60)-(-b.tried+(b.tried=+new Date)<w*4?1:0),b.defer=setTimeout(function g(){if(p&&p.hidden)return setTimeout(g,w);f(b)},w)))}var p=""+v!=typeof document&&document});var v})(t,"./websocket"),t(function(s){if(!(typeof Gun>"u")){var r=function(){},v;try{v=(Gun.window||r).localStorage}catch{}v||(Gun.log("Warning: No localStorage exists to persist data to!"),v={setItem:function(h,c){this[h]=c},removeItem:function(h){delete this[h]},getItem:function(h){return this[h]}});var u=JSON.stringifyAsync||function(h,c,a,l){var f;try{c(f,JSON.stringify(h,a,l))}catch(w){c(w)}};Gun.on("create",function h(c){this.to.next(c);var a=c.opt;c.graph;var l=[],f,w,$,p;if(a.localStorage===!1)return;a.prefix=a.file||"gun/";try{f=h[a.prefix]=h[a.prefix]||JSON.parse($=v.getItem(a.prefix))||{}}catch{f=h[a.prefix]={}}$=($||"").length,c.on("get",function(g){this.to.next(g);var D=g.get,j,n,y,T;!D||!(j=D["#"])||(n=f[j]||T,n&&(y=D["."])&&!Object.plain(y)&&(n=Gun.state.ify({},y,Gun.state.is(n,y),n[y],j)),Gun.on.get.ack(g,n))}),c.on("put",function(g){this.to.next(g);var D=g.put,j=D["#"],n=D["."],y=g["#"],T=g.ok||"";if(f[j]=Gun.state.ify(f[j],n,D[">"],D[":"],j),p&&$>4999880){c.on("in",{"@":y,err:"localStorage max!"});return}!g["@"]&&(!g._.via||Math.random()<T["@"]/T["/"])&&l.push(y),!w&&(w=setTimeout(b,9+$/333))});function b(){if(!l.length&&((setTimeout.turn||"").s||"").length){setTimeout(b,99);return}var g=l;clearTimeout(w),w=!1,l=[],u(f,function(D,j){try{!D&&v.setItem(a.prefix,j)}catch(n){D=p=n||"localStorage failure"}D&&(Gun.log(D+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),c.on("localStorage:error",{err:D,get:a.prefix,put:f})),$=j.length,setTimeout.each(g,function(n){c.on("in",{"@":n,err:D,ok:0})},0,99)})}})}})(t,"./localStorage")})(),function(){var I;if(""+I!=typeof Gun){var t=function(d){console.warn("Warning! Deprecated internal utility will break in next version:",d)},i=Gun;i.fn=i.fn||{is:function(d){return t("fn"),!!d&&typeof d=="function"}},i.bi=i.bi||{is:function(d){return t("bi"),d instanceof Boolean||typeof d=="boolean"}},i.num=i.num||{is:function(d){return t("num"),!s(d)&&(d-parseFloat(d)+1>=0||d===1/0||d===-1/0)}},i.text=i.text||{is:function(d){return t("text"),typeof d=="string"}},i.text.ify=i.text.ify||function(d){return t("text.ify"),i.text.is(d)?d:typeof JSON<"u"?JSON.stringify(d):d&&d.toString?d.toString():d},i.text.random=i.text.random||function(d,e){t("text.random");var _="";for(d=d||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";d>0;)_+=e.charAt(Math.floor(Math.random()*e.length)),d--;return _},i.text.match=i.text.match||function(d,e){var _,m;return t("text.match"),typeof d!="string"?!1:(typeof e=="string"&&(e={"=":e}),e=e||{},_=e["="]||e["*"]||e[">"]||e["<"],d===_?!0:m!==e["="]?!1:(_=e["*"]||e[">"]||e["<"],d.slice(0,(_||"").length)===_?!0:m!==e["*"]?!1:m!==e[">"]&&m!==e["<"]?d>=e[">"]&&d<=e["<"]:m!==e[">"]&&d>=e[">"]||m!==e["<"]&&d<=e["<"]))},i.text.hash=i.text.hash||function(d,e){if(t("text.hash"),typeof d=="string"){if(e=e||0,!d.length)return e;for(var _=0,m=d.length,E;_<m;++_)E=d.charCodeAt(_),e=(e<<5)-e+E,e|=0;return e}},i.list=i.list||{is:function(d){return t("list"),d instanceof Array}},i.list.slit=i.list.slit||Array.prototype.slice,i.list.sort=i.list.sort||function(d){return t("list.sort"),function(e,_){return!e||!_?0:(e=e[d],_=_[d],e<_?-1:e>_?1:0)}},i.list.map=i.list.map||function(d,e,_){return t("list.map"),A(d,e,_)},i.list.index=1,i.obj=i.boj||{is:function(d){return t("obj"),d?d instanceof Object&&d.constructor===Object||Object.prototype.toString.call(d).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},i.obj.put=i.obj.put||function(d,e,_){return t("obj.put"),(d||{})[e]=_,d},i.obj.has=i.obj.has||function(d,e){return t("obj.has"),d&&Object.prototype.hasOwnProperty.call(d,e)},i.obj.del=i.obj.del||function(d,e){if(t("obj.del"),!!d)return d[e]=null,delete d[e],d},i.obj.as=i.obj.as||function(d,e,_,m){return t("obj.as"),d[e]=d[e]||(m===_?{}:_)},i.obj.ify=i.obj.ify||function(d){if(t("obj.ify"),y(d))return d;try{d=JSON.parse(d)}catch{d={}}return d},function(){var d;function e(_,m){x(this,m)&&d!==this[m]||(this[m]=_)}i.obj.to=i.obj.to||function(_,m){return t("obj.to"),m=m||{},A(_,e,m),m}}(),i.obj.copy=i.obj.copy||function(d){return t("obj.copy"),d&&JSON.parse(JSON.stringify(d))},function(){function d(e,_){var m=this.n,E;if(!(m&&(_===m||y(m)&&x(m,_)))&&E!==_)return!0}i.obj.empty=i.obj.empty||function(e,_){return t("obj.empty"),e?!A(e,d,{n:_}):!0}}(),function(){function d(m,E){if(arguments.length===2){d.r=d.r||{},d.r[m]=E;return}d.r=d.r||[],d.r.push(m)}var e=Object.keys,_;Object.keys=Object.keys||function(m){return _(m,function(E,G,S){S(G)})},i.obj.map=_=i.obj.map||function(m,E,G){t("obj.map");var S,N=0,M,B,H,P,W=typeof E=="function";if(d.r=S,e&&y(m)&&(H=e(m),P=!0),G=G||{},s(m)||H)for(M=(H||m).length;N<M;N++){var U=N+i.list.index;if(W){if(B=P?E.call(G,m[H[N]],H[N],d):E.call(G,m[N],U,d),B!==S)return B}else if(E===m[P?H[N]:N])return H?H[N]:U}else for(N in m)if(W){if(x(m,N)&&(B=G?E.call(G,m[N],N,d):E(m[N],N,d),B!==S))return B}else if(E===m[N])return N;return W?d.r:i.list.index?0:-1}}(),i.time=i.time||{},i.time.is=i.time.is||function(d){return t("time"),d?d instanceof Date:+new Date().getTime()};var j=i.fn.is,s=i.list.is,n=i.obj,y=n.is,x=n.has,A=n.map,r={};r.is=function(d){return t("val.is"),d===I?!1:d===null?!0:d===1/0?!1:h(d)||u(d)||p(d)?!0:r.link.is(d)||!1},r.link=r.rel={_:"#"},function(){r.link.is=function(e){if(t("val.link.is"),e&&e[v]&&!e._&&y(e)){var _={};if(A(e,d,_),_.id)return _.id}return!1};function d(e,_){var m=this;if(m.id)return m.id=!1;if(_==v&&h(e))m.id=e;else return m.id=!1}}(),r.link.ify=function(d){return t("val.link.ify"),O({},v,d)},i.obj.has._=".";var v=r.link._,I,u=i.bi.is,p=i.num.is,h=i.text.is,n=i.obj,y=n.is,O=n.put,A=n.map;i.val=i.val||r;var c={_:"_"};c.soul=function(d,e){return t("node.soul"),d&&d._&&d._[e||f]},c.soul.ify=function(d,e){return t("node.soul.ify"),e=typeof e=="string"?{soul:e}:e||{},d=d||{},d._=d._||{},d._[f]=e.soul||d._[f]||l(),d},c.soul._=r.link._,function(){c.is=function(e,_,m){t("node.is");var E;return y(e)&&(E=c.soul(e))?!A(e,d,{as:m,cb:_,s:E,n:e}):!1};function d(e,_){if(_!==c._){if(!r.is(e))return!0;this.cb&&this.cb.call(this.as,e,_,this.n,this.s)}}}(),function(){c.ify=function(e,_,m){return t("node.ify"),_?typeof _=="string"?_={soul:_}:typeof _=="function"&&(_={map:_}):_={},_.map&&(_.node=_.map.call(m,e,I,_.node||{})),(_.node=c.soul.ify(_.node||{},_))&&A(e,d,{o:_,as:m}),_.node};function d(e,_){var m=this.o,E,G;if(m.map){E=m.map.call(this.as,e,""+_,m.node),G===E?T(m.node,_):m.node&&(m.node[_]=E);return}r.is(e)&&(m.node[_]=e)}}();var n=i.obj,y=n.is,T=n.del,A=n.map,a=i.text,l=a.random,f=c.soul._,I;i.node=i.node||c;var w=i.state;w.lex=function(){return t("state.lex"),w().toString(36).replace(".","")},w.to=function(d,e,_){t("state.to");var m=(d||{})[e];return y(m)&&(m=C(m)),w.ify(_,e,w.is(d,e),m,c.soul(d))},function(){w.map=function(e,_,m){t("state.map");var E,G=y(G=e||_)?G:null;return e=j(e=e||_)?e:null,G&&!e?(_=p(_)?_:w(),G[g]=G[g]||{},A(G,d,{o:G,s:_}),G):(m=m||y(_)?_:E,_=p(_)?_:w(),function(S,N,M,B){if(!e)return d.call({o:M,s:_},S,N),S;e.call(m||this||{},S,N,M,B),!(x(M,N)&&E===M[N])&&d.call({o:M,s:_},S,N)})};function d(e,_){g!==_&&w.ify(this.o,_,this.s)}}();var n=i.obj;n.as;var x=n.has,y=n.is,A=n.map,C=n.copy,$=i.num,p=$.is,b=i.fn,j=b.is,g=c._,I,D={};(function(){D.is=function(_,m,E,G){return t("graph.is"),!_||!y(_)||k(_)?!1:!A(_,d,{cb:m,fn:E,as:G})};function d(_,m){if(!_||m!==c.soul(_)||!c.is(_,this.fn,this.as))return!0;this.cb&&(e.n=_,e.as=this.as,this.cb.call(e.as,_,m,e))}function e(_){_&&c.is(e.n,_,e.as)}})(),function(){D.ify=function(G,S,N){t("graph.ify");var M={path:[],obj:G};return S?typeof S=="string"?S={soul:S}:typeof S=="function"&&(S.map=S):S={},typeof N=="string"&&(S.soul=S.soul||N,N=I),S.soul&&(M.link=r.link.ify(S.soul)),S.shell=(N||{}).shell,S.graph=S.graph||{},S.seen=S.seen||[],S.as=S.as||N,d(S,M),S.root=M.node,S.graph};function d(G,S){var N;return(N=E(G,S))?N:(S.env=G,S.soul=_,c.ify(S.obj,e,S)&&(S.link=S.link||r.link.ify(c.soul(S.node)),S.obj!==G.shell&&(G.graph[r.link.is(S.link)]=S.node)),S)}function e(G,S,N){var M=this,B=M.env,H,P;if(c._===S&&x(G,r.link._))return N._;if(H=m(G,S,N,M,B)){if(S||(M.node=M.node||N||{},x(G,c._)&&c.soul(G)&&(M.node._=C(G._)),M.node=c.soul.ify(M.node,r.link.is(M.link)),M.link=M.link||r.link.ify(c.soul(M.node))),(P=B.map)&&(P.call(B.as||{},G,S,N,M),x(N,S))){if(G=N[S],I===G){T(N,S);return}if(!(H=m(G,S,N,M,B)))return}if(!S)return M.node;if(H===!0)return G;if(P=d(B,{obj:G,path:M.path.concat(S)}),!!P.node)return P.link}}function _(G){var S=this,N=r.link.is(S.link),M=S.env.graph;S.link=S.link||r.link.ify(G),S.link[r.link._]=G,S.node&&S.node[c._]&&(S.node[c._][r.link._]=G),x(M,N)&&(M[G]=M[N],T(M,N))}function m(G,S,N,M,B){var H;if(r.is(G))return!0;if(y(G))return 1;if(H=B.invalid)return G=H.call(B.as||{},G,S,N),m(G,S,N,M,B);B.err="Invalid value at '"+M.path.concat(S).join(".")+"'!",i.list.is(G)&&(B.err+=" Use `.set(item)` instead of an Array.")}function E(G,S){for(var N=G.seen,M=N.length,B;M--;)if(B=N[M],S.obj===B.obj)return B;N.push(S)}}(),D.node=function(d){t("graph.node");var e=c.soul(d);if(e)return O({},e,d)},function(){D.to=function(e,_,m){if(t("graph.to"),!!e){var E={};return m=m||{seen:{}},A(e[_],d,{obj:E,graph:e,opt:m}),E}};function d(e,_){var m,E;if(c._===_){if(k(e,r.link._))return;this.obj[_]=C(e);return}if(!(m=r.link.is(e))){this.obj[_]=e;return}if(E=this.opt.seen[m]){this.obj[_]=E;return}this.obj[_]=this.opt.seen[m]=D.to(this.graph,m,this.opt)}}();var j=i.fn.is,n=i.obj,y=n.is,T=n.del,x=n.has,k=n.empty,O=n.put,A=n.map,C=n.copy,I;i.graph=i.graph||D}}()})(Et);var He=Et.exports,Pe=He;const Fe=Me(Pe),ft=[];function Je(o,t=tt){let i;const s=new Set;function r(h){if(ot(o,h)&&(o=h,i)){const c=!ft.length;for(const a of s)a[1](),ft.push(a,o);if(c){for(let a=0;a<ft.length;a+=2)ft[a][0](ft[a+1]);ft.length=0}}}function v(h){r(h(o))}function u(h,c=tt){const a=[h,c];return s.add(a),s.size===1&&(i=t(r,v)||tt),h(o),()=>{s.delete(a),s.size===0&&i&&(i(),i=null)}}return{set:r,update:v,subscribe:u}}const qe=Fe({peers:["wss://gun-manhattan.herokuapp.com/gun"]}),te=qe.get("cards"),Tt=Je([]),Rt=o=>{te.put({data:JSON.stringify(o)})};te.on(o=>{Tt.set(JSON.parse(o.data))});function zt(o,t,i){const s=o.slice();return s[5]=t[i],s}function We(o){let t;return{c(){t=ht("add two sided")},m(i,s){q(i,t,s)},d(i){i&&J(t)}}}function Re(o){let t;return{c(){t=ht("add one sided")},m(i,s){q(i,t,s)},d(i){i&&J(t)}}}function ze(o){let t;return{c(){t=ht("save")},m(i,s){q(i,t,s)},d(i){i&&J(t)}}}function Ue(o){let t;return{c(){t=ht("remove")},m(i,s){q(i,t,s)},d(i){i&&J(t)}}}function Ut(o){let t,i,s,r,v,u;i=new Ce({props:{card:o[5]}});function h(){return o[4](o[5])}return r=new wt({props:{colour:"red",$$slots:{default:[Ue]},$$scope:{ctx:o}}}),r.$on("click",h),{c(){t=R("div"),Z(i.$$.fragment),s=K(),Z(r.$$.fragment),v=K(),F(t,"class","wrapper svelte-z9e1s4")},m(c,a){q(c,t,a),V(i,t,null),X(t,s),V(r,t,null),X(t,v),u=!0},p(c,a){o=c;const l={};a&1&&(l.card=o[5]),i.$set(l);const f={};a&256&&(f.$$scope={dirty:a,ctx:o}),r.$set(f)},i(c){u||(z(i.$$.fragment,c),z(r.$$.fragment,c),u=!0)},o(c){L(i.$$.fragment,c),L(r.$$.fragment,c),u=!1},d(c){c&&J(t),Q(i),Q(r)}}}function Le(o){let t,i,s,r,v,u,h,c,a,l,f;i=new wt({props:{colour:"blue",$$slots:{default:[We]},$$scope:{ctx:o}}}),i.$on("click",o[1]),r=new wt({props:{colour:"blue",$$slots:{default:[Re]},$$scope:{ctx:o}}}),r.$on("click",o[2]),u=new wt({props:{$$slots:{default:[ze]},$$scope:{ctx:o}}}),u.$on("click",o[3]);let w=St(o[0]),$=[];for(let b=0;b<w.length;b+=1)$[b]=Ut(zt(o,w,b));const p=b=>L($[b],1,1,()=>{$[b]=null});return{c(){t=R("section"),Z(i.$$.fragment),s=K(),Z(r.$$.fragment),v=K(),Z(u.$$.fragment),h=K(),c=R("h1"),c.textContent="cards",a=K(),l=R("section");for(let b=0;b<$.length;b+=1)$[b].c();F(t,"class","button-container svelte-z9e1s4"),F(l,"class","container svelte-z9e1s4")},m(b,g){q(b,t,g),V(i,t,null),X(t,s),V(r,t,null),X(t,v),V(u,t,null),q(b,h,g),q(b,c,g),q(b,a,g),q(b,l,g);for(let D=0;D<$.length;D+=1)$[D]&&$[D].m(l,null);f=!0},p(b,[g]){const D={};g&256&&(D.$$scope={dirty:g,ctx:b}),i.$set(D);const j={};g&256&&(j.$$scope={dirty:g,ctx:b}),r.$set(j);const n={};if(g&256&&(n.$$scope={dirty:g,ctx:b}),u.$set(n),g&1){w=St(b[0]);let y;for(y=0;y<w.length;y+=1){const T=zt(b,w,y);$[y]?($[y].p(T,g),z($[y],1)):($[y]=Ut(T),$[y].c(),z($[y],1),$[y].m(l,null))}for(Yt(),y=w.length;y<$.length;y+=1)p(y);Zt()}},i(b){if(!f){z(i.$$.fragment,b),z(r.$$.fragment,b),z(u.$$.fragment,b);for(let g=0;g<w.length;g+=1)z($[g]);f=!0}},o(b){L(i.$$.fragment,b),L(r.$$.fragment,b),L(u.$$.fragment,b),$=$.filter(Boolean);for(let g=0;g<$.length;g+=1)L($[g]);f=!1},d(b){b&&(J(t),J(h),J(c),J(a),J(l)),Q(i),Q(r),Q(u),Qt($,b)}}}function Ke(o,t,i){let s;return ue(o,Tt,c=>i(0,s=c)),[s,()=>{Tt.set([...s,Pt(2)])},()=>{Tt.set([...s,Pt(1)]),console.log(s.length)},()=>{Rt(s)},c=>{Rt(s.filter(a=>a.id!==c.id))}]}class Ve extends pt{constructor(t){super(),dt(this,t,Ke,Le,ot,{})}}new Ve({target:document.getElementById("app")});
